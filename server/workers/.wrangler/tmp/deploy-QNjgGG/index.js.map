{
  "version": 3,
  "sources": ["../../../node_modules/hono/dist/compose.js", "../../../node_modules/hono/dist/request/constants.js", "../../../node_modules/hono/dist/utils/body.js", "../../../node_modules/hono/dist/utils/url.js", "../../../node_modules/hono/dist/request.js", "../../../node_modules/hono/dist/utils/html.js", "../../../node_modules/hono/dist/context.js", "../../../node_modules/hono/dist/router.js", "../../../node_modules/hono/dist/utils/constants.js", "../../../node_modules/hono/dist/hono-base.js", "../../../node_modules/hono/dist/router/reg-exp-router/matcher.js", "../../../node_modules/hono/dist/router/reg-exp-router/node.js", "../../../node_modules/hono/dist/router/reg-exp-router/trie.js", "../../../node_modules/hono/dist/router/reg-exp-router/router.js", "../../../node_modules/hono/dist/router/smart-router/router.js", "../../../node_modules/hono/dist/router/trie-router/node.js", "../../../node_modules/hono/dist/router/trie-router/router.js", "../../../node_modules/hono/dist/hono.js", "../../../node_modules/hono/dist/middleware/cors/index.js", "../../../node_modules/hono/dist/utils/color.js", "../../../node_modules/hono/dist/middleware/logger/index.js", "../../../node_modules/hono/dist/middleware/pretty-json/index.js", "../../../src/services/database.ts", "../../../src/services/cache.ts", "../../../src/routes/templates.ts", "../../../src/routes/sections.ts", "../../../src/routes/upload.ts", "../../../src/routes/elements.ts", "../../../src/routes/rsvp.ts", "../../../node_modules/hono/dist/utils/cookie.js", "../../../node_modules/hono/dist/helper/cookie/index.js", "../../../src/routes/auth.ts", "../../../src/routes/batch.ts", "../../../src/index.ts"],
  "sourceRoot": "C:\\Users\\62896\\Documents\\tamuuid\\server\\workers\\.wrangler\\tmp\\deploy-QNjgGG",
  "sourcesContent": ["// src/compose.ts\nvar compose = (middleware, onError, onNotFound) => {\n  return (context, next) => {\n    let index = -1;\n    return dispatch(0);\n    async function dispatch(i) {\n      if (i <= index) {\n        throw new Error(\"next() called multiple times\");\n      }\n      index = i;\n      let res;\n      let isError = false;\n      let handler;\n      if (middleware[i]) {\n        handler = middleware[i][0][0];\n        context.req.routeIndex = i;\n      } else {\n        handler = i === middleware.length && next || void 0;\n      }\n      if (handler) {\n        try {\n          res = await handler(context, () => dispatch(i + 1));\n        } catch (err) {\n          if (err instanceof Error && onError) {\n            context.error = err;\n            res = await onError(err, context);\n            isError = true;\n          } else {\n            throw err;\n          }\n        }\n      } else {\n        if (context.finalized === false && onNotFound) {\n          res = await onNotFound(context);\n        }\n      }\n      if (res && (context.finalized === false || isError)) {\n        context.res = res;\n      }\n      return context;\n    }\n  };\n};\nexport {\n  compose\n};\n", "// src/request/constants.ts\nvar GET_MATCH_RESULT = /* @__PURE__ */ Symbol();\nexport {\n  GET_MATCH_RESULT\n};\n", "// src/utils/body.ts\nimport { HonoRequest } from \"../request.js\";\nvar parseBody = async (request, options = /* @__PURE__ */ Object.create(null)) => {\n  const { all = false, dot = false } = options;\n  const headers = request instanceof HonoRequest ? request.raw.headers : request.headers;\n  const contentType = headers.get(\"Content-Type\");\n  if (contentType?.startsWith(\"multipart/form-data\") || contentType?.startsWith(\"application/x-www-form-urlencoded\")) {\n    return parseFormData(request, { all, dot });\n  }\n  return {};\n};\nasync function parseFormData(request, options) {\n  const formData = await request.formData();\n  if (formData) {\n    return convertFormDataToBodyData(formData, options);\n  }\n  return {};\n}\nfunction convertFormDataToBodyData(formData, options) {\n  const form = /* @__PURE__ */ Object.create(null);\n  formData.forEach((value, key) => {\n    const shouldParseAllValues = options.all || key.endsWith(\"[]\");\n    if (!shouldParseAllValues) {\n      form[key] = value;\n    } else {\n      handleParsingAllValues(form, key, value);\n    }\n  });\n  if (options.dot) {\n    Object.entries(form).forEach(([key, value]) => {\n      const shouldParseDotValues = key.includes(\".\");\n      if (shouldParseDotValues) {\n        handleParsingNestedValues(form, key, value);\n        delete form[key];\n      }\n    });\n  }\n  return form;\n}\nvar handleParsingAllValues = (form, key, value) => {\n  if (form[key] !== void 0) {\n    if (Array.isArray(form[key])) {\n      ;\n      form[key].push(value);\n    } else {\n      form[key] = [form[key], value];\n    }\n  } else {\n    if (!key.endsWith(\"[]\")) {\n      form[key] = value;\n    } else {\n      form[key] = [value];\n    }\n  }\n};\nvar handleParsingNestedValues = (form, key, value) => {\n  let nestedForm = form;\n  const keys = key.split(\".\");\n  keys.forEach((key2, index) => {\n    if (index === keys.length - 1) {\n      nestedForm[key2] = value;\n    } else {\n      if (!nestedForm[key2] || typeof nestedForm[key2] !== \"object\" || Array.isArray(nestedForm[key2]) || nestedForm[key2] instanceof File) {\n        nestedForm[key2] = /* @__PURE__ */ Object.create(null);\n      }\n      nestedForm = nestedForm[key2];\n    }\n  });\n};\nexport {\n  parseBody\n};\n", "// src/utils/url.ts\nvar splitPath = (path) => {\n  const paths = path.split(\"/\");\n  if (paths[0] === \"\") {\n    paths.shift();\n  }\n  return paths;\n};\nvar splitRoutingPath = (routePath) => {\n  const { groups, path } = extractGroupsFromPath(routePath);\n  const paths = splitPath(path);\n  return replaceGroupMarks(paths, groups);\n};\nvar extractGroupsFromPath = (path) => {\n  const groups = [];\n  path = path.replace(/\\{[^}]+\\}/g, (match, index) => {\n    const mark = `@${index}`;\n    groups.push([mark, match]);\n    return mark;\n  });\n  return { groups, path };\n};\nvar replaceGroupMarks = (paths, groups) => {\n  for (let i = groups.length - 1; i >= 0; i--) {\n    const [mark] = groups[i];\n    for (let j = paths.length - 1; j >= 0; j--) {\n      if (paths[j].includes(mark)) {\n        paths[j] = paths[j].replace(mark, groups[i][1]);\n        break;\n      }\n    }\n  }\n  return paths;\n};\nvar patternCache = {};\nvar getPattern = (label, next) => {\n  if (label === \"*\") {\n    return \"*\";\n  }\n  const match = label.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n  if (match) {\n    const cacheKey = `${label}#${next}`;\n    if (!patternCache[cacheKey]) {\n      if (match[2]) {\n        patternCache[cacheKey] = next && next[0] !== \":\" && next[0] !== \"*\" ? [cacheKey, match[1], new RegExp(`^${match[2]}(?=/${next})`)] : [label, match[1], new RegExp(`^${match[2]}$`)];\n      } else {\n        patternCache[cacheKey] = [label, match[1], true];\n      }\n    }\n    return patternCache[cacheKey];\n  }\n  return null;\n};\nvar tryDecode = (str, decoder) => {\n  try {\n    return decoder(str);\n  } catch {\n    return str.replace(/(?:%[0-9A-Fa-f]{2})+/g, (match) => {\n      try {\n        return decoder(match);\n      } catch {\n        return match;\n      }\n    });\n  }\n};\nvar tryDecodeURI = (str) => tryDecode(str, decodeURI);\nvar getPath = (request) => {\n  const url = request.url;\n  const start = url.indexOf(\"/\", url.indexOf(\":\") + 4);\n  let i = start;\n  for (; i < url.length; i++) {\n    const charCode = url.charCodeAt(i);\n    if (charCode === 37) {\n      const queryIndex = url.indexOf(\"?\", i);\n      const path = url.slice(start, queryIndex === -1 ? void 0 : queryIndex);\n      return tryDecodeURI(path.includes(\"%25\") ? path.replace(/%25/g, \"%2525\") : path);\n    } else if (charCode === 63) {\n      break;\n    }\n  }\n  return url.slice(start, i);\n};\nvar getQueryStrings = (url) => {\n  const queryIndex = url.indexOf(\"?\", 8);\n  return queryIndex === -1 ? \"\" : \"?\" + url.slice(queryIndex + 1);\n};\nvar getPathNoStrict = (request) => {\n  const result = getPath(request);\n  return result.length > 1 && result.at(-1) === \"/\" ? result.slice(0, -1) : result;\n};\nvar mergePath = (base, sub, ...rest) => {\n  if (rest.length) {\n    sub = mergePath(sub, ...rest);\n  }\n  return `${base?.[0] === \"/\" ? \"\" : \"/\"}${base}${sub === \"/\" ? \"\" : `${base?.at(-1) === \"/\" ? \"\" : \"/\"}${sub?.[0] === \"/\" ? sub.slice(1) : sub}`}`;\n};\nvar checkOptionalParameter = (path) => {\n  if (path.charCodeAt(path.length - 1) !== 63 || !path.includes(\":\")) {\n    return null;\n  }\n  const segments = path.split(\"/\");\n  const results = [];\n  let basePath = \"\";\n  segments.forEach((segment) => {\n    if (segment !== \"\" && !/\\:/.test(segment)) {\n      basePath += \"/\" + segment;\n    } else if (/\\:/.test(segment)) {\n      if (/\\?/.test(segment)) {\n        if (results.length === 0 && basePath === \"\") {\n          results.push(\"/\");\n        } else {\n          results.push(basePath);\n        }\n        const optionalSegment = segment.replace(\"?\", \"\");\n        basePath += \"/\" + optionalSegment;\n        results.push(basePath);\n      } else {\n        basePath += \"/\" + segment;\n      }\n    }\n  });\n  return results.filter((v, i, a) => a.indexOf(v) === i);\n};\nvar _decodeURI = (value) => {\n  if (!/[%+]/.test(value)) {\n    return value;\n  }\n  if (value.indexOf(\"+\") !== -1) {\n    value = value.replace(/\\+/g, \" \");\n  }\n  return value.indexOf(\"%\") !== -1 ? tryDecode(value, decodeURIComponent_) : value;\n};\nvar _getQueryParam = (url, key, multiple) => {\n  let encoded;\n  if (!multiple && key && !/[%+]/.test(key)) {\n    let keyIndex2 = url.indexOf(\"?\", 8);\n    if (keyIndex2 === -1) {\n      return void 0;\n    }\n    if (!url.startsWith(key, keyIndex2 + 1)) {\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    while (keyIndex2 !== -1) {\n      const trailingKeyCode = url.charCodeAt(keyIndex2 + key.length + 1);\n      if (trailingKeyCode === 61) {\n        const valueIndex = keyIndex2 + key.length + 2;\n        const endIndex = url.indexOf(\"&\", valueIndex);\n        return _decodeURI(url.slice(valueIndex, endIndex === -1 ? void 0 : endIndex));\n      } else if (trailingKeyCode == 38 || isNaN(trailingKeyCode)) {\n        return \"\";\n      }\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    encoded = /[%+]/.test(url);\n    if (!encoded) {\n      return void 0;\n    }\n  }\n  const results = {};\n  encoded ??= /[%+]/.test(url);\n  let keyIndex = url.indexOf(\"?\", 8);\n  while (keyIndex !== -1) {\n    const nextKeyIndex = url.indexOf(\"&\", keyIndex + 1);\n    let valueIndex = url.indexOf(\"=\", keyIndex);\n    if (valueIndex > nextKeyIndex && nextKeyIndex !== -1) {\n      valueIndex = -1;\n    }\n    let name = url.slice(\n      keyIndex + 1,\n      valueIndex === -1 ? nextKeyIndex === -1 ? void 0 : nextKeyIndex : valueIndex\n    );\n    if (encoded) {\n      name = _decodeURI(name);\n    }\n    keyIndex = nextKeyIndex;\n    if (name === \"\") {\n      continue;\n    }\n    let value;\n    if (valueIndex === -1) {\n      value = \"\";\n    } else {\n      value = url.slice(valueIndex + 1, nextKeyIndex === -1 ? void 0 : nextKeyIndex);\n      if (encoded) {\n        value = _decodeURI(value);\n      }\n    }\n    if (multiple) {\n      if (!(results[name] && Array.isArray(results[name]))) {\n        results[name] = [];\n      }\n      ;\n      results[name].push(value);\n    } else {\n      results[name] ??= value;\n    }\n  }\n  return key ? results[key] : results;\n};\nvar getQueryParam = _getQueryParam;\nvar getQueryParams = (url, key) => {\n  return _getQueryParam(url, key, true);\n};\nvar decodeURIComponent_ = decodeURIComponent;\nexport {\n  checkOptionalParameter,\n  decodeURIComponent_,\n  getPath,\n  getPathNoStrict,\n  getPattern,\n  getQueryParam,\n  getQueryParams,\n  getQueryStrings,\n  mergePath,\n  splitPath,\n  splitRoutingPath,\n  tryDecode\n};\n", "// src/request.ts\nimport { HTTPException } from \"./http-exception.js\";\nimport { GET_MATCH_RESULT } from \"./request/constants.js\";\nimport { parseBody } from \"./utils/body.js\";\nimport { decodeURIComponent_, getQueryParam, getQueryParams, tryDecode } from \"./utils/url.js\";\nvar tryDecodeURIComponent = (str) => tryDecode(str, decodeURIComponent_);\nvar HonoRequest = class {\n  /**\n   * `.raw` can get the raw Request object.\n   *\n   * @see {@link https://hono.dev/docs/api/request#raw}\n   *\n   * @example\n   * ```ts\n   * // For Cloudflare Workers\n   * app.post('/', async (c) => {\n   *   const metadata = c.req.raw.cf?.hostMetadata?\n   *   ...\n   * })\n   * ```\n   */\n  raw;\n  #validatedData;\n  // Short name of validatedData\n  #matchResult;\n  routeIndex = 0;\n  /**\n   * `.path` can get the pathname of the request.\n   *\n   * @see {@link https://hono.dev/docs/api/request#path}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const pathname = c.req.path // `/about/me`\n   * })\n   * ```\n   */\n  path;\n  bodyCache = {};\n  constructor(request, path = \"/\", matchResult = [[]]) {\n    this.raw = request;\n    this.path = path;\n    this.#matchResult = matchResult;\n    this.#validatedData = {};\n  }\n  param(key) {\n    return key ? this.#getDecodedParam(key) : this.#getAllDecodedParams();\n  }\n  #getDecodedParam(key) {\n    const paramKey = this.#matchResult[0][this.routeIndex][1][key];\n    const param = this.#getParamValue(paramKey);\n    return param && /\\%/.test(param) ? tryDecodeURIComponent(param) : param;\n  }\n  #getAllDecodedParams() {\n    const decoded = {};\n    const keys = Object.keys(this.#matchResult[0][this.routeIndex][1]);\n    for (const key of keys) {\n      const value = this.#getParamValue(this.#matchResult[0][this.routeIndex][1][key]);\n      if (value !== void 0) {\n        decoded[key] = /\\%/.test(value) ? tryDecodeURIComponent(value) : value;\n      }\n    }\n    return decoded;\n  }\n  #getParamValue(paramKey) {\n    return this.#matchResult[1] ? this.#matchResult[1][paramKey] : paramKey;\n  }\n  query(key) {\n    return getQueryParam(this.url, key);\n  }\n  queries(key) {\n    return getQueryParams(this.url, key);\n  }\n  header(name) {\n    if (name) {\n      return this.raw.headers.get(name) ?? void 0;\n    }\n    const headerData = {};\n    this.raw.headers.forEach((value, key) => {\n      headerData[key] = value;\n    });\n    return headerData;\n  }\n  async parseBody(options) {\n    return this.bodyCache.parsedBody ??= await parseBody(this, options);\n  }\n  #cachedBody = (key) => {\n    const { bodyCache, raw } = this;\n    const cachedBody = bodyCache[key];\n    if (cachedBody) {\n      return cachedBody;\n    }\n    const anyCachedKey = Object.keys(bodyCache)[0];\n    if (anyCachedKey) {\n      return bodyCache[anyCachedKey].then((body) => {\n        if (anyCachedKey === \"json\") {\n          body = JSON.stringify(body);\n        }\n        return new Response(body)[key]();\n      });\n    }\n    return bodyCache[key] = raw[key]();\n  };\n  /**\n   * `.json()` can parse Request body of type `application/json`\n   *\n   * @see {@link https://hono.dev/docs/api/request#json}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.json()\n   * })\n   * ```\n   */\n  json() {\n    return this.#cachedBody(\"text\").then((text) => JSON.parse(text));\n  }\n  /**\n   * `.text()` can parse Request body of type `text/plain`\n   *\n   * @see {@link https://hono.dev/docs/api/request#text}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.text()\n   * })\n   * ```\n   */\n  text() {\n    return this.#cachedBody(\"text\");\n  }\n  /**\n   * `.arrayBuffer()` parse Request body as an `ArrayBuffer`\n   *\n   * @see {@link https://hono.dev/docs/api/request#arraybuffer}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.arrayBuffer()\n   * })\n   * ```\n   */\n  arrayBuffer() {\n    return this.#cachedBody(\"arrayBuffer\");\n  }\n  /**\n   * Parses the request body as a `Blob`.\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.blob();\n   * });\n   * ```\n   * @see https://hono.dev/docs/api/request#blob\n   */\n  blob() {\n    return this.#cachedBody(\"blob\");\n  }\n  /**\n   * Parses the request body as `FormData`.\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.formData();\n   * });\n   * ```\n   * @see https://hono.dev/docs/api/request#formdata\n   */\n  formData() {\n    return this.#cachedBody(\"formData\");\n  }\n  /**\n   * Adds validated data to the request.\n   *\n   * @param target - The target of the validation.\n   * @param data - The validated data to add.\n   */\n  addValidatedData(target, data) {\n    this.#validatedData[target] = data;\n  }\n  valid(target) {\n    return this.#validatedData[target];\n  }\n  /**\n   * `.url()` can get the request url strings.\n   *\n   * @see {@link https://hono.dev/docs/api/request#url}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const url = c.req.url // `http://localhost:8787/about/me`\n   *   ...\n   * })\n   * ```\n   */\n  get url() {\n    return this.raw.url;\n  }\n  /**\n   * `.method()` can get the method name of the request.\n   *\n   * @see {@link https://hono.dev/docs/api/request#method}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const method = c.req.method // `GET`\n   * })\n   * ```\n   */\n  get method() {\n    return this.raw.method;\n  }\n  get [GET_MATCH_RESULT]() {\n    return this.#matchResult;\n  }\n  /**\n   * `.matchedRoutes()` can return a matched route in the handler\n   *\n   * @deprecated\n   *\n   * Use matchedRoutes helper defined in \"hono/route\" instead.\n   *\n   * @see {@link https://hono.dev/docs/api/request#matchedroutes}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async function logger(c, next) {\n   *   await next()\n   *   c.req.matchedRoutes.forEach(({ handler, method, path }, i) => {\n   *     const name = handler.name || (handler.length < 2 ? '[handler]' : '[middleware]')\n   *     console.log(\n   *       method,\n   *       ' ',\n   *       path,\n   *       ' '.repeat(Math.max(10 - path.length, 0)),\n   *       name,\n   *       i === c.req.routeIndex ? '<- respond from here' : ''\n   *     )\n   *   })\n   * })\n   * ```\n   */\n  get matchedRoutes() {\n    return this.#matchResult[0].map(([[, route]]) => route);\n  }\n  /**\n   * `routePath()` can retrieve the path registered within the handler\n   *\n   * @deprecated\n   *\n   * Use routePath helper defined in \"hono/route\" instead.\n   *\n   * @see {@link https://hono.dev/docs/api/request#routepath}\n   *\n   * @example\n   * ```ts\n   * app.get('/posts/:id', (c) => {\n   *   return c.json({ path: c.req.routePath })\n   * })\n   * ```\n   */\n  get routePath() {\n    return this.#matchResult[0].map(([[, route]]) => route)[this.routeIndex].path;\n  }\n};\nvar cloneRawRequest = async (req) => {\n  if (!req.raw.bodyUsed) {\n    return req.raw.clone();\n  }\n  const cacheKey = Object.keys(req.bodyCache)[0];\n  if (!cacheKey) {\n    throw new HTTPException(500, {\n      message: \"Cannot clone request: body was already consumed and not cached. Please use HonoRequest methods (e.g., req.json(), req.text()) instead of consuming req.raw directly.\"\n    });\n  }\n  const requestInit = {\n    body: await req[cacheKey](),\n    cache: req.raw.cache,\n    credentials: req.raw.credentials,\n    headers: req.header(),\n    integrity: req.raw.integrity,\n    keepalive: req.raw.keepalive,\n    method: req.method,\n    mode: req.raw.mode,\n    redirect: req.raw.redirect,\n    referrer: req.raw.referrer,\n    referrerPolicy: req.raw.referrerPolicy,\n    signal: req.raw.signal\n  };\n  return new Request(req.url, requestInit);\n};\nexport {\n  HonoRequest,\n  cloneRawRequest\n};\n", "// src/utils/html.ts\nvar HtmlEscapedCallbackPhase = {\n  Stringify: 1,\n  BeforeStream: 2,\n  Stream: 3\n};\nvar raw = (value, callbacks) => {\n  const escapedString = new String(value);\n  escapedString.isEscaped = true;\n  escapedString.callbacks = callbacks;\n  return escapedString;\n};\nvar escapeRe = /[&<>'\"]/;\nvar stringBufferToString = async (buffer, callbacks) => {\n  let str = \"\";\n  callbacks ||= [];\n  const resolvedBuffer = await Promise.all(buffer);\n  for (let i = resolvedBuffer.length - 1; ; i--) {\n    str += resolvedBuffer[i];\n    i--;\n    if (i < 0) {\n      break;\n    }\n    let r = resolvedBuffer[i];\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    const isEscaped = r.isEscaped;\n    r = await (typeof r === \"object\" ? r.toString() : r);\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    if (r.isEscaped ?? isEscaped) {\n      str += r;\n    } else {\n      const buf = [str];\n      escapeToBuffer(r, buf);\n      str = buf[0];\n    }\n  }\n  return raw(str, callbacks);\n};\nvar escapeToBuffer = (str, buffer) => {\n  const match = str.search(escapeRe);\n  if (match === -1) {\n    buffer[0] += str;\n    return;\n  }\n  let escape;\n  let index;\n  let lastIndex = 0;\n  for (index = match; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34:\n        escape = \"&quot;\";\n        break;\n      case 39:\n        escape = \"&#39;\";\n        break;\n      case 38:\n        escape = \"&amp;\";\n        break;\n      case 60:\n        escape = \"&lt;\";\n        break;\n      case 62:\n        escape = \"&gt;\";\n        break;\n      default:\n        continue;\n    }\n    buffer[0] += str.substring(lastIndex, index) + escape;\n    lastIndex = index + 1;\n  }\n  buffer[0] += str.substring(lastIndex, index);\n};\nvar resolveCallbackSync = (str) => {\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return str;\n  }\n  const buffer = [str];\n  const context = {};\n  callbacks.forEach((c) => c({ phase: HtmlEscapedCallbackPhase.Stringify, buffer, context }));\n  return buffer[0];\n};\nvar resolveCallback = async (str, phase, preserveCallbacks, context, buffer) => {\n  if (typeof str === \"object\" && !(str instanceof String)) {\n    if (!(str instanceof Promise)) {\n      str = str.toString();\n    }\n    if (str instanceof Promise) {\n      str = await str;\n    }\n  }\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return Promise.resolve(str);\n  }\n  if (buffer) {\n    buffer[0] += str;\n  } else {\n    buffer = [str];\n  }\n  const resStr = Promise.all(callbacks.map((c) => c({ phase, buffer, context }))).then(\n    (res) => Promise.all(\n      res.filter(Boolean).map((str2) => resolveCallback(str2, phase, false, context, buffer))\n    ).then(() => buffer[0])\n  );\n  if (preserveCallbacks) {\n    return raw(await resStr, callbacks);\n  } else {\n    return resStr;\n  }\n};\nexport {\n  HtmlEscapedCallbackPhase,\n  escapeToBuffer,\n  raw,\n  resolveCallback,\n  resolveCallbackSync,\n  stringBufferToString\n};\n", "// src/context.ts\nimport { HonoRequest } from \"./request.js\";\nimport { HtmlEscapedCallbackPhase, resolveCallback } from \"./utils/html.js\";\nvar TEXT_PLAIN = \"text/plain; charset=UTF-8\";\nvar setDefaultContentType = (contentType, headers) => {\n  return {\n    \"Content-Type\": contentType,\n    ...headers\n  };\n};\nvar Context = class {\n  #rawRequest;\n  #req;\n  /**\n   * `.env` can get bindings (environment variables, secrets, KV namespaces, D1 database, R2 bucket etc.) in Cloudflare Workers.\n   *\n   * @see {@link https://hono.dev/docs/api/context#env}\n   *\n   * @example\n   * ```ts\n   * // Environment object for Cloudflare Workers\n   * app.get('*', async c => {\n   *   const counter = c.env.COUNTER\n   * })\n   * ```\n   */\n  env = {};\n  #var;\n  finalized = false;\n  /**\n   * `.error` can get the error object from the middleware if the Handler throws an error.\n   *\n   * @see {@link https://hono.dev/docs/api/context#error}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async (c, next) => {\n   *   await next()\n   *   if (c.error) {\n   *     // do something...\n   *   }\n   * })\n   * ```\n   */\n  error;\n  #status;\n  #executionCtx;\n  #res;\n  #layout;\n  #renderer;\n  #notFoundHandler;\n  #preparedHeaders;\n  #matchResult;\n  #path;\n  /**\n   * Creates an instance of the Context class.\n   *\n   * @param req - The Request object.\n   * @param options - Optional configuration options for the context.\n   */\n  constructor(req, options) {\n    this.#rawRequest = req;\n    if (options) {\n      this.#executionCtx = options.executionCtx;\n      this.env = options.env;\n      this.#notFoundHandler = options.notFoundHandler;\n      this.#path = options.path;\n      this.#matchResult = options.matchResult;\n    }\n  }\n  /**\n   * `.req` is the instance of {@link HonoRequest}.\n   */\n  get req() {\n    this.#req ??= new HonoRequest(this.#rawRequest, this.#path, this.#matchResult);\n    return this.#req;\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#event}\n   * The FetchEvent associated with the current request.\n   *\n   * @throws Will throw an error if the context does not have a FetchEvent.\n   */\n  get event() {\n    if (this.#executionCtx && \"respondWith\" in this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no FetchEvent\");\n    }\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#executionctx}\n   * The ExecutionContext associated with the current request.\n   *\n   * @throws Will throw an error if the context does not have an ExecutionContext.\n   */\n  get executionCtx() {\n    if (this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no ExecutionContext\");\n    }\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#res}\n   * The Response object for the current request.\n   */\n  get res() {\n    return this.#res ||= new Response(null, {\n      headers: this.#preparedHeaders ??= new Headers()\n    });\n  }\n  /**\n   * Sets the Response object for the current request.\n   *\n   * @param _res - The Response object to set.\n   */\n  set res(_res) {\n    if (this.#res && _res) {\n      _res = new Response(_res.body, _res);\n      for (const [k, v] of this.#res.headers.entries()) {\n        if (k === \"content-type\") {\n          continue;\n        }\n        if (k === \"set-cookie\") {\n          const cookies = this.#res.headers.getSetCookie();\n          _res.headers.delete(\"set-cookie\");\n          for (const cookie of cookies) {\n            _res.headers.append(\"set-cookie\", cookie);\n          }\n        } else {\n          _res.headers.set(k, v);\n        }\n      }\n    }\n    this.#res = _res;\n    this.finalized = true;\n  }\n  /**\n   * `.render()` can create a response within a layout.\n   *\n   * @see {@link https://hono.dev/docs/api/context#render-setrenderer}\n   *\n   * @example\n   * ```ts\n   * app.get('/', (c) => {\n   *   return c.render('Hello!')\n   * })\n   * ```\n   */\n  render = (...args) => {\n    this.#renderer ??= (content) => this.html(content);\n    return this.#renderer(...args);\n  };\n  /**\n   * Sets the layout for the response.\n   *\n   * @param layout - The layout to set.\n   * @returns The layout function.\n   */\n  setLayout = (layout) => this.#layout = layout;\n  /**\n   * Gets the current layout for the response.\n   *\n   * @returns The current layout function.\n   */\n  getLayout = () => this.#layout;\n  /**\n   * `.setRenderer()` can set the layout in the custom middleware.\n   *\n   * @see {@link https://hono.dev/docs/api/context#render-setrenderer}\n   *\n   * @example\n   * ```tsx\n   * app.use('*', async (c, next) => {\n   *   c.setRenderer((content) => {\n   *     return c.html(\n   *       <html>\n   *         <body>\n   *           <p>{content}</p>\n   *         </body>\n   *       </html>\n   *     )\n   *   })\n   *   await next()\n   * })\n   * ```\n   */\n  setRenderer = (renderer) => {\n    this.#renderer = renderer;\n  };\n  /**\n   * `.header()` can set headers.\n   *\n   * @see {@link https://hono.dev/docs/api/context#header}\n   *\n   * @example\n   * ```ts\n   * app.get('/welcome', (c) => {\n   *   // Set headers\n   *   c.header('X-Message', 'Hello!')\n   *   c.header('Content-Type', 'text/plain')\n   *\n   *   return c.body('Thank you for coming')\n   * })\n   * ```\n   */\n  header = (name, value, options) => {\n    if (this.finalized) {\n      this.#res = new Response(this.#res.body, this.#res);\n    }\n    const headers = this.#res ? this.#res.headers : this.#preparedHeaders ??= new Headers();\n    if (value === void 0) {\n      headers.delete(name);\n    } else if (options?.append) {\n      headers.append(name, value);\n    } else {\n      headers.set(name, value);\n    }\n  };\n  status = (status) => {\n    this.#status = status;\n  };\n  /**\n   * `.set()` can set the value specified by the key.\n   *\n   * @see {@link https://hono.dev/docs/api/context#set-get}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async (c, next) => {\n   *   c.set('message', 'Hono is hot!!')\n   *   await next()\n   * })\n   * ```\n   */\n  set = (key, value) => {\n    this.#var ??= /* @__PURE__ */ new Map();\n    this.#var.set(key, value);\n  };\n  /**\n   * `.get()` can use the value specified by the key.\n   *\n   * @see {@link https://hono.dev/docs/api/context#set-get}\n   *\n   * @example\n   * ```ts\n   * app.get('/', (c) => {\n   *   const message = c.get('message')\n   *   return c.text(`The message is \"${message}\"`)\n   * })\n   * ```\n   */\n  get = (key) => {\n    return this.#var ? this.#var.get(key) : void 0;\n  };\n  /**\n   * `.var` can access the value of a variable.\n   *\n   * @see {@link https://hono.dev/docs/api/context#var}\n   *\n   * @example\n   * ```ts\n   * const result = c.var.client.oneMethod()\n   * ```\n   */\n  // c.var.propName is a read-only\n  get var() {\n    if (!this.#var) {\n      return {};\n    }\n    return Object.fromEntries(this.#var);\n  }\n  #newResponse(data, arg, headers) {\n    const responseHeaders = this.#res ? new Headers(this.#res.headers) : this.#preparedHeaders ?? new Headers();\n    if (typeof arg === \"object\" && \"headers\" in arg) {\n      const argHeaders = arg.headers instanceof Headers ? arg.headers : new Headers(arg.headers);\n      for (const [key, value] of argHeaders) {\n        if (key.toLowerCase() === \"set-cookie\") {\n          responseHeaders.append(key, value);\n        } else {\n          responseHeaders.set(key, value);\n        }\n      }\n    }\n    if (headers) {\n      for (const [k, v] of Object.entries(headers)) {\n        if (typeof v === \"string\") {\n          responseHeaders.set(k, v);\n        } else {\n          responseHeaders.delete(k);\n          for (const v2 of v) {\n            responseHeaders.append(k, v2);\n          }\n        }\n      }\n    }\n    const status = typeof arg === \"number\" ? arg : arg?.status ?? this.#status;\n    return new Response(data, { status, headers: responseHeaders });\n  }\n  newResponse = (...args) => this.#newResponse(...args);\n  /**\n   * `.body()` can return the HTTP response.\n   * You can set headers with `.header()` and set HTTP status code with `.status`.\n   * This can also be set in `.text()`, `.json()` and so on.\n   *\n   * @see {@link https://hono.dev/docs/api/context#body}\n   *\n   * @example\n   * ```ts\n   * app.get('/welcome', (c) => {\n   *   // Set headers\n   *   c.header('X-Message', 'Hello!')\n   *   c.header('Content-Type', 'text/plain')\n   *   // Set HTTP status code\n   *   c.status(201)\n   *\n   *   // Return the response body\n   *   return c.body('Thank you for coming')\n   * })\n   * ```\n   */\n  body = (data, arg, headers) => this.#newResponse(data, arg, headers);\n  /**\n   * `.text()` can render text as `Content-Type:text/plain`.\n   *\n   * @see {@link https://hono.dev/docs/api/context#text}\n   *\n   * @example\n   * ```ts\n   * app.get('/say', (c) => {\n   *   return c.text('Hello!')\n   * })\n   * ```\n   */\n  text = (text, arg, headers) => {\n    return !this.#preparedHeaders && !this.#status && !arg && !headers && !this.finalized ? new Response(text) : this.#newResponse(\n      text,\n      arg,\n      setDefaultContentType(TEXT_PLAIN, headers)\n    );\n  };\n  /**\n   * `.json()` can render JSON as `Content-Type:application/json`.\n   *\n   * @see {@link https://hono.dev/docs/api/context#json}\n   *\n   * @example\n   * ```ts\n   * app.get('/api', (c) => {\n   *   return c.json({ message: 'Hello!' })\n   * })\n   * ```\n   */\n  json = (object, arg, headers) => {\n    return this.#newResponse(\n      JSON.stringify(object),\n      arg,\n      setDefaultContentType(\"application/json\", headers)\n    );\n  };\n  html = (html, arg, headers) => {\n    const res = (html2) => this.#newResponse(html2, arg, setDefaultContentType(\"text/html; charset=UTF-8\", headers));\n    return typeof html === \"object\" ? resolveCallback(html, HtmlEscapedCallbackPhase.Stringify, false, {}).then(res) : res(html);\n  };\n  /**\n   * `.redirect()` can Redirect, default status code is 302.\n   *\n   * @see {@link https://hono.dev/docs/api/context#redirect}\n   *\n   * @example\n   * ```ts\n   * app.get('/redirect', (c) => {\n   *   return c.redirect('/')\n   * })\n   * app.get('/redirect-permanently', (c) => {\n   *   return c.redirect('/', 301)\n   * })\n   * ```\n   */\n  redirect = (location, status) => {\n    const locationString = String(location);\n    this.header(\n      \"Location\",\n      // Multibyes should be encoded\n      // eslint-disable-next-line no-control-regex\n      !/[^\\x00-\\xFF]/.test(locationString) ? locationString : encodeURI(locationString)\n    );\n    return this.newResponse(null, status ?? 302);\n  };\n  /**\n   * `.notFound()` can return the Not Found Response.\n   *\n   * @see {@link https://hono.dev/docs/api/context#notfound}\n   *\n   * @example\n   * ```ts\n   * app.get('/notfound', (c) => {\n   *   return c.notFound()\n   * })\n   * ```\n   */\n  notFound = () => {\n    this.#notFoundHandler ??= () => new Response();\n    return this.#notFoundHandler(this);\n  };\n};\nexport {\n  Context,\n  TEXT_PLAIN\n};\n", "// src/router.ts\nvar METHOD_NAME_ALL = \"ALL\";\nvar METHOD_NAME_ALL_LOWERCASE = \"all\";\nvar METHODS = [\"get\", \"post\", \"put\", \"delete\", \"options\", \"patch\"];\nvar MESSAGE_MATCHER_IS_ALREADY_BUILT = \"Can not add a route since the matcher is already built.\";\nvar UnsupportedPathError = class extends Error {\n};\nexport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHODS,\n  METHOD_NAME_ALL,\n  METHOD_NAME_ALL_LOWERCASE,\n  UnsupportedPathError\n};\n", "// src/utils/constants.ts\nvar COMPOSED_HANDLER = \"__COMPOSED_HANDLER\";\nexport {\n  COMPOSED_HANDLER\n};\n", "// src/hono-base.ts\nimport { compose } from \"./compose.js\";\nimport { Context } from \"./context.js\";\nimport { METHODS, METHOD_NAME_ALL, METHOD_NAME_ALL_LOWERCASE } from \"./router.js\";\nimport { COMPOSED_HANDLER } from \"./utils/constants.js\";\nimport { getPath, getPathNoStrict, mergePath } from \"./utils/url.js\";\nvar notFoundHandler = (c) => {\n  return c.text(\"404 Not Found\", 404);\n};\nvar errorHandler = (err, c) => {\n  if (\"getResponse\" in err) {\n    const res = err.getResponse();\n    return c.newResponse(res.body, res);\n  }\n  console.error(err);\n  return c.text(\"Internal Server Error\", 500);\n};\nvar Hono = class _Hono {\n  get;\n  post;\n  put;\n  delete;\n  options;\n  patch;\n  all;\n  on;\n  use;\n  /*\n    This class is like an abstract class and does not have a router.\n    To use it, inherit the class and implement router in the constructor.\n  */\n  router;\n  getPath;\n  // Cannot use `#` because it requires visibility at JavaScript runtime.\n  _basePath = \"/\";\n  #path = \"/\";\n  routes = [];\n  constructor(options = {}) {\n    const allMethods = [...METHODS, METHOD_NAME_ALL_LOWERCASE];\n    allMethods.forEach((method) => {\n      this[method] = (args1, ...args) => {\n        if (typeof args1 === \"string\") {\n          this.#path = args1;\n        } else {\n          this.#addRoute(method, this.#path, args1);\n        }\n        args.forEach((handler) => {\n          this.#addRoute(method, this.#path, handler);\n        });\n        return this;\n      };\n    });\n    this.on = (method, path, ...handlers) => {\n      for (const p of [path].flat()) {\n        this.#path = p;\n        for (const m of [method].flat()) {\n          handlers.map((handler) => {\n            this.#addRoute(m.toUpperCase(), this.#path, handler);\n          });\n        }\n      }\n      return this;\n    };\n    this.use = (arg1, ...handlers) => {\n      if (typeof arg1 === \"string\") {\n        this.#path = arg1;\n      } else {\n        this.#path = \"*\";\n        handlers.unshift(arg1);\n      }\n      handlers.forEach((handler) => {\n        this.#addRoute(METHOD_NAME_ALL, this.#path, handler);\n      });\n      return this;\n    };\n    const { strict, ...optionsWithoutStrict } = options;\n    Object.assign(this, optionsWithoutStrict);\n    this.getPath = strict ?? true ? options.getPath ?? getPath : getPathNoStrict;\n  }\n  #clone() {\n    const clone = new _Hono({\n      router: this.router,\n      getPath: this.getPath\n    });\n    clone.errorHandler = this.errorHandler;\n    clone.#notFoundHandler = this.#notFoundHandler;\n    clone.routes = this.routes;\n    return clone;\n  }\n  #notFoundHandler = notFoundHandler;\n  // Cannot use `#` because it requires visibility at JavaScript runtime.\n  errorHandler = errorHandler;\n  /**\n   * `.route()` allows grouping other Hono instance in routes.\n   *\n   * @see {@link https://hono.dev/docs/api/routing#grouping}\n   *\n   * @param {string} path - base Path\n   * @param {Hono} app - other Hono instance\n   * @returns {Hono} routed Hono instance\n   *\n   * @example\n   * ```ts\n   * const app = new Hono()\n   * const app2 = new Hono()\n   *\n   * app2.get(\"/user\", (c) => c.text(\"user\"))\n   * app.route(\"/api\", app2) // GET /api/user\n   * ```\n   */\n  route(path, app) {\n    const subApp = this.basePath(path);\n    app.routes.map((r) => {\n      let handler;\n      if (app.errorHandler === errorHandler) {\n        handler = r.handler;\n      } else {\n        handler = async (c, next) => (await compose([], app.errorHandler)(c, () => r.handler(c, next))).res;\n        handler[COMPOSED_HANDLER] = r.handler;\n      }\n      subApp.#addRoute(r.method, r.path, handler);\n    });\n    return this;\n  }\n  /**\n   * `.basePath()` allows base paths to be specified.\n   *\n   * @see {@link https://hono.dev/docs/api/routing#base-path}\n   *\n   * @param {string} path - base Path\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * const api = new Hono().basePath('/api')\n   * ```\n   */\n  basePath(path) {\n    const subApp = this.#clone();\n    subApp._basePath = mergePath(this._basePath, path);\n    return subApp;\n  }\n  /**\n   * `.onError()` handles an error and returns a customized Response.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#error-handling}\n   *\n   * @param {ErrorHandler} handler - request Handler for error\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * app.onError((err, c) => {\n   *   console.error(`${err}`)\n   *   return c.text('Custom Error Message', 500)\n   * })\n   * ```\n   */\n  onError = (handler) => {\n    this.errorHandler = handler;\n    return this;\n  };\n  /**\n   * `.notFound()` allows you to customize a Not Found Response.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#not-found}\n   *\n   * @param {NotFoundHandler} handler - request handler for not-found\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * app.notFound((c) => {\n   *   return c.text('Custom 404 Message', 404)\n   * })\n   * ```\n   */\n  notFound = (handler) => {\n    this.#notFoundHandler = handler;\n    return this;\n  };\n  /**\n   * `.mount()` allows you to mount applications built with other frameworks into your Hono application.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#mount}\n   *\n   * @param {string} path - base Path\n   * @param {Function} applicationHandler - other Request Handler\n   * @param {MountOptions} [options] - options of `.mount()`\n   * @returns {Hono} mounted Hono instance\n   *\n   * @example\n   * ```ts\n   * import { Router as IttyRouter } from 'itty-router'\n   * import { Hono } from 'hono'\n   * // Create itty-router application\n   * const ittyRouter = IttyRouter()\n   * // GET /itty-router/hello\n   * ittyRouter.get('/hello', () => new Response('Hello from itty-router'))\n   *\n   * const app = new Hono()\n   * app.mount('/itty-router', ittyRouter.handle)\n   * ```\n   *\n   * @example\n   * ```ts\n   * const app = new Hono()\n   * // Send the request to another application without modification.\n   * app.mount('/app', anotherApp, {\n   *   replaceRequest: (req) => req,\n   * })\n   * ```\n   */\n  mount(path, applicationHandler, options) {\n    let replaceRequest;\n    let optionHandler;\n    if (options) {\n      if (typeof options === \"function\") {\n        optionHandler = options;\n      } else {\n        optionHandler = options.optionHandler;\n        if (options.replaceRequest === false) {\n          replaceRequest = (request) => request;\n        } else {\n          replaceRequest = options.replaceRequest;\n        }\n      }\n    }\n    const getOptions = optionHandler ? (c) => {\n      const options2 = optionHandler(c);\n      return Array.isArray(options2) ? options2 : [options2];\n    } : (c) => {\n      let executionContext = void 0;\n      try {\n        executionContext = c.executionCtx;\n      } catch {\n      }\n      return [c.env, executionContext];\n    };\n    replaceRequest ||= (() => {\n      const mergedPath = mergePath(this._basePath, path);\n      const pathPrefixLength = mergedPath === \"/\" ? 0 : mergedPath.length;\n      return (request) => {\n        const url = new URL(request.url);\n        url.pathname = url.pathname.slice(pathPrefixLength) || \"/\";\n        return new Request(url, request);\n      };\n    })();\n    const handler = async (c, next) => {\n      const res = await applicationHandler(replaceRequest(c.req.raw), ...getOptions(c));\n      if (res) {\n        return res;\n      }\n      await next();\n    };\n    this.#addRoute(METHOD_NAME_ALL, mergePath(path, \"*\"), handler);\n    return this;\n  }\n  #addRoute(method, path, handler) {\n    method = method.toUpperCase();\n    path = mergePath(this._basePath, path);\n    const r = { basePath: this._basePath, path, method, handler };\n    this.router.add(method, path, [handler, r]);\n    this.routes.push(r);\n  }\n  #handleError(err, c) {\n    if (err instanceof Error) {\n      return this.errorHandler(err, c);\n    }\n    throw err;\n  }\n  #dispatch(request, executionCtx, env, method) {\n    if (method === \"HEAD\") {\n      return (async () => new Response(null, await this.#dispatch(request, executionCtx, env, \"GET\")))();\n    }\n    const path = this.getPath(request, { env });\n    const matchResult = this.router.match(method, path);\n    const c = new Context(request, {\n      path,\n      matchResult,\n      env,\n      executionCtx,\n      notFoundHandler: this.#notFoundHandler\n    });\n    if (matchResult[0].length === 1) {\n      let res;\n      try {\n        res = matchResult[0][0][0][0](c, async () => {\n          c.res = await this.#notFoundHandler(c);\n        });\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n      return res instanceof Promise ? res.then(\n        (resolved) => resolved || (c.finalized ? c.res : this.#notFoundHandler(c))\n      ).catch((err) => this.#handleError(err, c)) : res ?? this.#notFoundHandler(c);\n    }\n    const composed = compose(matchResult[0], this.errorHandler, this.#notFoundHandler);\n    return (async () => {\n      try {\n        const context = await composed(c);\n        if (!context.finalized) {\n          throw new Error(\n            \"Context is not finalized. Did you forget to return a Response object or `await next()`?\"\n          );\n        }\n        return context.res;\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n    })();\n  }\n  /**\n   * `.fetch()` will be entry point of your app.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#fetch}\n   *\n   * @param {Request} request - request Object of request\n   * @param {Env} Env - env Object\n   * @param {ExecutionContext} - context of execution\n   * @returns {Response | Promise<Response>} response of request\n   *\n   */\n  fetch = (request, ...rest) => {\n    return this.#dispatch(request, rest[1], rest[0], request.method);\n  };\n  /**\n   * `.request()` is a useful method for testing.\n   * You can pass a URL or pathname to send a GET request.\n   * app will return a Response object.\n   * ```ts\n   * test('GET /hello is ok', async () => {\n   *   const res = await app.request('/hello')\n   *   expect(res.status).toBe(200)\n   * })\n   * ```\n   * @see https://hono.dev/docs/api/hono#request\n   */\n  request = (input, requestInit, Env, executionCtx) => {\n    if (input instanceof Request) {\n      return this.fetch(requestInit ? new Request(input, requestInit) : input, Env, executionCtx);\n    }\n    input = input.toString();\n    return this.fetch(\n      new Request(\n        /^https?:\\/\\//.test(input) ? input : `http://localhost${mergePath(\"/\", input)}`,\n        requestInit\n      ),\n      Env,\n      executionCtx\n    );\n  };\n  /**\n   * `.fire()` automatically adds a global fetch event listener.\n   * This can be useful for environments that adhere to the Service Worker API, such as non-ES module Cloudflare Workers.\n   * @deprecated\n   * Use `fire` from `hono/service-worker` instead.\n   * ```ts\n   * import { Hono } from 'hono'\n   * import { fire } from 'hono/service-worker'\n   *\n   * const app = new Hono()\n   * // ...\n   * fire(app)\n   * ```\n   * @see https://hono.dev/docs/api/hono#fire\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API\n   * @see https://developers.cloudflare.com/workers/reference/migrate-to-module-workers/\n   */\n  fire = () => {\n    addEventListener(\"fetch\", (event) => {\n      event.respondWith(this.#dispatch(event.request, event, void 0, event.request.method));\n    });\n  };\n};\nexport {\n  Hono as HonoBase\n};\n", "// src/router/reg-exp-router/matcher.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nvar emptyParam = [];\nfunction match(method, path) {\n  const matchers = this.buildAllMatchers();\n  const match2 = ((method2, path2) => {\n    const matcher = matchers[method2] || matchers[METHOD_NAME_ALL];\n    const staticMatch = matcher[2][path2];\n    if (staticMatch) {\n      return staticMatch;\n    }\n    const match3 = path2.match(matcher[0]);\n    if (!match3) {\n      return [[], emptyParam];\n    }\n    const index = match3.indexOf(\"\", 1);\n    return [matcher[1][index], match3];\n  });\n  this.match = match2;\n  return match2(method, path);\n}\nexport {\n  emptyParam,\n  match\n};\n", "// src/router/reg-exp-router/node.ts\nvar LABEL_REG_EXP_STR = \"[^/]+\";\nvar ONLY_WILDCARD_REG_EXP_STR = \".*\";\nvar TAIL_WILDCARD_REG_EXP_STR = \"(?:|/.*)\";\nvar PATH_ERROR = /* @__PURE__ */ Symbol();\nvar regExpMetaChars = new Set(\".\\\\+*[^]$()\");\nfunction compareKey(a, b) {\n  if (a.length === 1) {\n    return b.length === 1 ? a < b ? -1 : 1 : -1;\n  }\n  if (b.length === 1) {\n    return 1;\n  }\n  if (a === ONLY_WILDCARD_REG_EXP_STR || a === TAIL_WILDCARD_REG_EXP_STR) {\n    return 1;\n  } else if (b === ONLY_WILDCARD_REG_EXP_STR || b === TAIL_WILDCARD_REG_EXP_STR) {\n    return -1;\n  }\n  if (a === LABEL_REG_EXP_STR) {\n    return 1;\n  } else if (b === LABEL_REG_EXP_STR) {\n    return -1;\n  }\n  return a.length === b.length ? a < b ? -1 : 1 : b.length - a.length;\n}\nvar Node = class _Node {\n  #index;\n  #varIndex;\n  #children = /* @__PURE__ */ Object.create(null);\n  insert(tokens, index, paramMap, context, pathErrorCheckOnly) {\n    if (tokens.length === 0) {\n      if (this.#index !== void 0) {\n        throw PATH_ERROR;\n      }\n      if (pathErrorCheckOnly) {\n        return;\n      }\n      this.#index = index;\n      return;\n    }\n    const [token, ...restTokens] = tokens;\n    const pattern = token === \"*\" ? restTokens.length === 0 ? [\"\", \"\", ONLY_WILDCARD_REG_EXP_STR] : [\"\", \"\", LABEL_REG_EXP_STR] : token === \"/*\" ? [\"\", \"\", TAIL_WILDCARD_REG_EXP_STR] : token.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n    let node;\n    if (pattern) {\n      const name = pattern[1];\n      let regexpStr = pattern[2] || LABEL_REG_EXP_STR;\n      if (name && pattern[2]) {\n        if (regexpStr === \".*\") {\n          throw PATH_ERROR;\n        }\n        regexpStr = regexpStr.replace(/^\\((?!\\?:)(?=[^)]+\\)$)/, \"(?:\");\n        if (/\\((?!\\?:)/.test(regexpStr)) {\n          throw PATH_ERROR;\n        }\n      }\n      node = this.#children[regexpStr];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[regexpStr] = new _Node();\n        if (name !== \"\") {\n          node.#varIndex = context.varIndex++;\n        }\n      }\n      if (!pathErrorCheckOnly && name !== \"\") {\n        paramMap.push([name, node.#varIndex]);\n      }\n    } else {\n      node = this.#children[token];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k.length > 1 && k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[token] = new _Node();\n      }\n    }\n    node.insert(restTokens, index, paramMap, context, pathErrorCheckOnly);\n  }\n  buildRegExpStr() {\n    const childKeys = Object.keys(this.#children).sort(compareKey);\n    const strList = childKeys.map((k) => {\n      const c = this.#children[k];\n      return (typeof c.#varIndex === \"number\" ? `(${k})@${c.#varIndex}` : regExpMetaChars.has(k) ? `\\\\${k}` : k) + c.buildRegExpStr();\n    });\n    if (typeof this.#index === \"number\") {\n      strList.unshift(`#${this.#index}`);\n    }\n    if (strList.length === 0) {\n      return \"\";\n    }\n    if (strList.length === 1) {\n      return strList[0];\n    }\n    return \"(?:\" + strList.join(\"|\") + \")\";\n  }\n};\nexport {\n  Node,\n  PATH_ERROR\n};\n", "// src/router/reg-exp-router/trie.ts\nimport { Node } from \"./node.js\";\nvar Trie = class {\n  #context = { varIndex: 0 };\n  #root = new Node();\n  insert(path, index, pathErrorCheckOnly) {\n    const paramAssoc = [];\n    const groups = [];\n    for (let i = 0; ; ) {\n      let replaced = false;\n      path = path.replace(/\\{[^}]+\\}/g, (m) => {\n        const mark = `@\\\\${i}`;\n        groups[i] = [mark, m];\n        i++;\n        replaced = true;\n        return mark;\n      });\n      if (!replaced) {\n        break;\n      }\n    }\n    const tokens = path.match(/(?::[^\\/]+)|(?:\\/\\*$)|./g) || [];\n    for (let i = groups.length - 1; i >= 0; i--) {\n      const [mark] = groups[i];\n      for (let j = tokens.length - 1; j >= 0; j--) {\n        if (tokens[j].indexOf(mark) !== -1) {\n          tokens[j] = tokens[j].replace(mark, groups[i][1]);\n          break;\n        }\n      }\n    }\n    this.#root.insert(tokens, index, paramAssoc, this.#context, pathErrorCheckOnly);\n    return paramAssoc;\n  }\n  buildRegExp() {\n    let regexp = this.#root.buildRegExpStr();\n    if (regexp === \"\") {\n      return [/^$/, [], []];\n    }\n    let captureIndex = 0;\n    const indexReplacementMap = [];\n    const paramReplacementMap = [];\n    regexp = regexp.replace(/#(\\d+)|@(\\d+)|\\.\\*\\$/g, (_, handlerIndex, paramIndex) => {\n      if (handlerIndex !== void 0) {\n        indexReplacementMap[++captureIndex] = Number(handlerIndex);\n        return \"$()\";\n      }\n      if (paramIndex !== void 0) {\n        paramReplacementMap[Number(paramIndex)] = ++captureIndex;\n        return \"\";\n      }\n      return \"\";\n    });\n    return [new RegExp(`^${regexp}`), indexReplacementMap, paramReplacementMap];\n  }\n};\nexport {\n  Trie\n};\n", "// src/router/reg-exp-router/router.ts\nimport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHOD_NAME_ALL,\n  UnsupportedPathError\n} from \"../../router.js\";\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { match, emptyParam } from \"./matcher.js\";\nimport { PATH_ERROR } from \"./node.js\";\nimport { Trie } from \"./trie.js\";\nvar nullMatcher = [/^$/, [], /* @__PURE__ */ Object.create(null)];\nvar wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\nfunction buildWildcardRegExp(path) {\n  return wildcardRegExpCache[path] ??= new RegExp(\n    path === \"*\" ? \"\" : `^${path.replace(\n      /\\/\\*$|([.\\\\+*[^\\]$()])/g,\n      (_, metaChar) => metaChar ? `\\\\${metaChar}` : \"(?:|/.*)\"\n    )}$`\n  );\n}\nfunction clearWildcardRegExpCache() {\n  wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\n}\nfunction buildMatcherFromPreprocessedRoutes(routes) {\n  const trie = new Trie();\n  const handlerData = [];\n  if (routes.length === 0) {\n    return nullMatcher;\n  }\n  const routesWithStaticPathFlag = routes.map(\n    (route) => [!/\\*|\\/:/.test(route[0]), ...route]\n  ).sort(\n    ([isStaticA, pathA], [isStaticB, pathB]) => isStaticA ? 1 : isStaticB ? -1 : pathA.length - pathB.length\n  );\n  const staticMap = /* @__PURE__ */ Object.create(null);\n  for (let i = 0, j = -1, len = routesWithStaticPathFlag.length; i < len; i++) {\n    const [pathErrorCheckOnly, path, handlers] = routesWithStaticPathFlag[i];\n    if (pathErrorCheckOnly) {\n      staticMap[path] = [handlers.map(([h]) => [h, /* @__PURE__ */ Object.create(null)]), emptyParam];\n    } else {\n      j++;\n    }\n    let paramAssoc;\n    try {\n      paramAssoc = trie.insert(path, j, pathErrorCheckOnly);\n    } catch (e) {\n      throw e === PATH_ERROR ? new UnsupportedPathError(path) : e;\n    }\n    if (pathErrorCheckOnly) {\n      continue;\n    }\n    handlerData[j] = handlers.map(([h, paramCount]) => {\n      const paramIndexMap = /* @__PURE__ */ Object.create(null);\n      paramCount -= 1;\n      for (; paramCount >= 0; paramCount--) {\n        const [key, value] = paramAssoc[paramCount];\n        paramIndexMap[key] = value;\n      }\n      return [h, paramIndexMap];\n    });\n  }\n  const [regexp, indexReplacementMap, paramReplacementMap] = trie.buildRegExp();\n  for (let i = 0, len = handlerData.length; i < len; i++) {\n    for (let j = 0, len2 = handlerData[i].length; j < len2; j++) {\n      const map = handlerData[i][j]?.[1];\n      if (!map) {\n        continue;\n      }\n      const keys = Object.keys(map);\n      for (let k = 0, len3 = keys.length; k < len3; k++) {\n        map[keys[k]] = paramReplacementMap[map[keys[k]]];\n      }\n    }\n  }\n  const handlerMap = [];\n  for (const i in indexReplacementMap) {\n    handlerMap[i] = handlerData[indexReplacementMap[i]];\n  }\n  return [regexp, handlerMap, staticMap];\n}\nfunction findMiddleware(middleware, path) {\n  if (!middleware) {\n    return void 0;\n  }\n  for (const k of Object.keys(middleware).sort((a, b) => b.length - a.length)) {\n    if (buildWildcardRegExp(k).test(path)) {\n      return [...middleware[k]];\n    }\n  }\n  return void 0;\n}\nvar RegExpRouter = class {\n  name = \"RegExpRouter\";\n  #middleware;\n  #routes;\n  constructor() {\n    this.#middleware = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n    this.#routes = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n  }\n  add(method, path, handler) {\n    const middleware = this.#middleware;\n    const routes = this.#routes;\n    if (!middleware || !routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    if (!middleware[method]) {\n      ;\n      [middleware, routes].forEach((handlerMap) => {\n        handlerMap[method] = /* @__PURE__ */ Object.create(null);\n        Object.keys(handlerMap[METHOD_NAME_ALL]).forEach((p) => {\n          handlerMap[method][p] = [...handlerMap[METHOD_NAME_ALL][p]];\n        });\n      });\n    }\n    if (path === \"/*\") {\n      path = \"*\";\n    }\n    const paramCount = (path.match(/\\/:/g) || []).length;\n    if (/\\*$/.test(path)) {\n      const re = buildWildcardRegExp(path);\n      if (method === METHOD_NAME_ALL) {\n        Object.keys(middleware).forEach((m) => {\n          middleware[m][path] ||= findMiddleware(middleware[m], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n        });\n      } else {\n        middleware[method][path] ||= findMiddleware(middleware[method], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n      }\n      Object.keys(middleware).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(middleware[m]).forEach((p) => {\n            re.test(p) && middleware[m][p].push([handler, paramCount]);\n          });\n        }\n      });\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(routes[m]).forEach(\n            (p) => re.test(p) && routes[m][p].push([handler, paramCount])\n          );\n        }\n      });\n      return;\n    }\n    const paths = checkOptionalParameter(path) || [path];\n    for (let i = 0, len = paths.length; i < len; i++) {\n      const path2 = paths[i];\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          routes[m][path2] ||= [\n            ...findMiddleware(middleware[m], path2) || findMiddleware(middleware[METHOD_NAME_ALL], path2) || []\n          ];\n          routes[m][path2].push([handler, paramCount - len + i + 1]);\n        }\n      });\n    }\n  }\n  match = match;\n  buildAllMatchers() {\n    const matchers = /* @__PURE__ */ Object.create(null);\n    Object.keys(this.#routes).concat(Object.keys(this.#middleware)).forEach((method) => {\n      matchers[method] ||= this.#buildMatcher(method);\n    });\n    this.#middleware = this.#routes = void 0;\n    clearWildcardRegExpCache();\n    return matchers;\n  }\n  #buildMatcher(method) {\n    const routes = [];\n    let hasOwnRoute = method === METHOD_NAME_ALL;\n    [this.#middleware, this.#routes].forEach((r) => {\n      const ownRoute = r[method] ? Object.keys(r[method]).map((path) => [path, r[method][path]]) : [];\n      if (ownRoute.length !== 0) {\n        hasOwnRoute ||= true;\n        routes.push(...ownRoute);\n      } else if (method !== METHOD_NAME_ALL) {\n        routes.push(\n          ...Object.keys(r[METHOD_NAME_ALL]).map((path) => [path, r[METHOD_NAME_ALL][path]])\n        );\n      }\n    });\n    if (!hasOwnRoute) {\n      return null;\n    } else {\n      return buildMatcherFromPreprocessedRoutes(routes);\n    }\n  }\n};\nexport {\n  RegExpRouter\n};\n", "// src/router/smart-router/router.ts\nimport { MESSAGE_MATCHER_IS_ALREADY_BUILT, UnsupportedPathError } from \"../../router.js\";\nvar SmartRouter = class {\n  name = \"SmartRouter\";\n  #routers = [];\n  #routes = [];\n  constructor(init) {\n    this.#routers = init.routers;\n  }\n  add(method, path, handler) {\n    if (!this.#routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    this.#routes.push([method, path, handler]);\n  }\n  match(method, path) {\n    if (!this.#routes) {\n      throw new Error(\"Fatal error\");\n    }\n    const routers = this.#routers;\n    const routes = this.#routes;\n    const len = routers.length;\n    let i = 0;\n    let res;\n    for (; i < len; i++) {\n      const router = routers[i];\n      try {\n        for (let i2 = 0, len2 = routes.length; i2 < len2; i2++) {\n          router.add(...routes[i2]);\n        }\n        res = router.match(method, path);\n      } catch (e) {\n        if (e instanceof UnsupportedPathError) {\n          continue;\n        }\n        throw e;\n      }\n      this.match = router.match.bind(router);\n      this.#routers = [router];\n      this.#routes = void 0;\n      break;\n    }\n    if (i === len) {\n      throw new Error(\"Fatal error\");\n    }\n    this.name = `SmartRouter + ${this.activeRouter.name}`;\n    return res;\n  }\n  get activeRouter() {\n    if (this.#routes || this.#routers.length !== 1) {\n      throw new Error(\"No active router has been determined yet.\");\n    }\n    return this.#routers[0];\n  }\n};\nexport {\n  SmartRouter\n};\n", "// src/router/trie-router/node.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nimport { getPattern, splitPath, splitRoutingPath } from \"../../utils/url.js\";\nvar emptyParams = /* @__PURE__ */ Object.create(null);\nvar Node = class _Node {\n  #methods;\n  #children;\n  #patterns;\n  #order = 0;\n  #params = emptyParams;\n  constructor(method, handler, children) {\n    this.#children = children || /* @__PURE__ */ Object.create(null);\n    this.#methods = [];\n    if (method && handler) {\n      const m = /* @__PURE__ */ Object.create(null);\n      m[method] = { handler, possibleKeys: [], score: 0 };\n      this.#methods = [m];\n    }\n    this.#patterns = [];\n  }\n  insert(method, path, handler) {\n    this.#order = ++this.#order;\n    let curNode = this;\n    const parts = splitRoutingPath(path);\n    const possibleKeys = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const p = parts[i];\n      const nextP = parts[i + 1];\n      const pattern = getPattern(p, nextP);\n      const key = Array.isArray(pattern) ? pattern[0] : p;\n      if (key in curNode.#children) {\n        curNode = curNode.#children[key];\n        if (pattern) {\n          possibleKeys.push(pattern[1]);\n        }\n        continue;\n      }\n      curNode.#children[key] = new _Node();\n      if (pattern) {\n        curNode.#patterns.push(pattern);\n        possibleKeys.push(pattern[1]);\n      }\n      curNode = curNode.#children[key];\n    }\n    curNode.#methods.push({\n      [method]: {\n        handler,\n        possibleKeys: possibleKeys.filter((v, i, a) => a.indexOf(v) === i),\n        score: this.#order\n      }\n    });\n    return curNode;\n  }\n  #getHandlerSets(node, method, nodeParams, params) {\n    const handlerSets = [];\n    for (let i = 0, len = node.#methods.length; i < len; i++) {\n      const m = node.#methods[i];\n      const handlerSet = m[method] || m[METHOD_NAME_ALL];\n      const processedSet = {};\n      if (handlerSet !== void 0) {\n        handlerSet.params = /* @__PURE__ */ Object.create(null);\n        handlerSets.push(handlerSet);\n        if (nodeParams !== emptyParams || params && params !== emptyParams) {\n          for (let i2 = 0, len2 = handlerSet.possibleKeys.length; i2 < len2; i2++) {\n            const key = handlerSet.possibleKeys[i2];\n            const processed = processedSet[handlerSet.score];\n            handlerSet.params[key] = params?.[key] && !processed ? params[key] : nodeParams[key] ?? params?.[key];\n            processedSet[handlerSet.score] = true;\n          }\n        }\n      }\n    }\n    return handlerSets;\n  }\n  search(method, path) {\n    const handlerSets = [];\n    this.#params = emptyParams;\n    const curNode = this;\n    let curNodes = [curNode];\n    const parts = splitPath(path);\n    const curNodesQueue = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const part = parts[i];\n      const isLast = i === len - 1;\n      const tempNodes = [];\n      for (let j = 0, len2 = curNodes.length; j < len2; j++) {\n        const node = curNodes[j];\n        const nextNode = node.#children[part];\n        if (nextNode) {\n          nextNode.#params = node.#params;\n          if (isLast) {\n            if (nextNode.#children[\"*\"]) {\n              handlerSets.push(\n                ...this.#getHandlerSets(nextNode.#children[\"*\"], method, node.#params)\n              );\n            }\n            handlerSets.push(...this.#getHandlerSets(nextNode, method, node.#params));\n          } else {\n            tempNodes.push(nextNode);\n          }\n        }\n        for (let k = 0, len3 = node.#patterns.length; k < len3; k++) {\n          const pattern = node.#patterns[k];\n          const params = node.#params === emptyParams ? {} : { ...node.#params };\n          if (pattern === \"*\") {\n            const astNode = node.#children[\"*\"];\n            if (astNode) {\n              handlerSets.push(...this.#getHandlerSets(astNode, method, node.#params));\n              astNode.#params = params;\n              tempNodes.push(astNode);\n            }\n            continue;\n          }\n          const [key, name, matcher] = pattern;\n          if (!part && !(matcher instanceof RegExp)) {\n            continue;\n          }\n          const child = node.#children[key];\n          const restPathString = parts.slice(i).join(\"/\");\n          if (matcher instanceof RegExp) {\n            const m = matcher.exec(restPathString);\n            if (m) {\n              params[name] = m[0];\n              handlerSets.push(...this.#getHandlerSets(child, method, node.#params, params));\n              if (Object.keys(child.#children).length) {\n                child.#params = params;\n                const componentCount = m[0].match(/\\//)?.length ?? 0;\n                const targetCurNodes = curNodesQueue[componentCount] ||= [];\n                targetCurNodes.push(child);\n              }\n              continue;\n            }\n          }\n          if (matcher === true || matcher.test(part)) {\n            params[name] = part;\n            if (isLast) {\n              handlerSets.push(...this.#getHandlerSets(child, method, params, node.#params));\n              if (child.#children[\"*\"]) {\n                handlerSets.push(\n                  ...this.#getHandlerSets(child.#children[\"*\"], method, params, node.#params)\n                );\n              }\n            } else {\n              child.#params = params;\n              tempNodes.push(child);\n            }\n          }\n        }\n      }\n      curNodes = tempNodes.concat(curNodesQueue.shift() ?? []);\n    }\n    if (handlerSets.length > 1) {\n      handlerSets.sort((a, b) => {\n        return a.score - b.score;\n      });\n    }\n    return [handlerSets.map(({ handler, params }) => [handler, params])];\n  }\n};\nexport {\n  Node\n};\n", "// src/router/trie-router/router.ts\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { Node } from \"./node.js\";\nvar TrieRouter = class {\n  name = \"TrieRouter\";\n  #node;\n  constructor() {\n    this.#node = new Node();\n  }\n  add(method, path, handler) {\n    const results = checkOptionalParameter(path);\n    if (results) {\n      for (let i = 0, len = results.length; i < len; i++) {\n        this.#node.insert(method, results[i], handler);\n      }\n      return;\n    }\n    this.#node.insert(method, path, handler);\n  }\n  match(method, path) {\n    return this.#node.search(method, path);\n  }\n};\nexport {\n  TrieRouter\n};\n", "// src/hono.ts\nimport { HonoBase } from \"./hono-base.js\";\nimport { RegExpRouter } from \"./router/reg-exp-router/index.js\";\nimport { SmartRouter } from \"./router/smart-router/index.js\";\nimport { TrieRouter } from \"./router/trie-router/index.js\";\nvar Hono = class extends HonoBase {\n  /**\n   * Creates an instance of the Hono class.\n   *\n   * @param options - Optional configuration options for the Hono instance.\n   */\n  constructor(options = {}) {\n    super(options);\n    this.router = options.router ?? new SmartRouter({\n      routers: [new RegExpRouter(), new TrieRouter()]\n    });\n  }\n};\nexport {\n  Hono\n};\n", "// src/middleware/cors/index.ts\nvar cors = (options) => {\n  const defaults = {\n    origin: \"*\",\n    allowMethods: [\"GET\", \"HEAD\", \"PUT\", \"POST\", \"DELETE\", \"PATCH\"],\n    allowHeaders: [],\n    exposeHeaders: []\n  };\n  const opts = {\n    ...defaults,\n    ...options\n  };\n  const findAllowOrigin = ((optsOrigin) => {\n    if (typeof optsOrigin === \"string\") {\n      if (optsOrigin === \"*\") {\n        return () => optsOrigin;\n      } else {\n        return (origin) => optsOrigin === origin ? origin : null;\n      }\n    } else if (typeof optsOrigin === \"function\") {\n      return optsOrigin;\n    } else {\n      return (origin) => optsOrigin.includes(origin) ? origin : null;\n    }\n  })(opts.origin);\n  const findAllowMethods = ((optsAllowMethods) => {\n    if (typeof optsAllowMethods === \"function\") {\n      return optsAllowMethods;\n    } else if (Array.isArray(optsAllowMethods)) {\n      return () => optsAllowMethods;\n    } else {\n      return () => [];\n    }\n  })(opts.allowMethods);\n  return async function cors2(c, next) {\n    function set(key, value) {\n      c.res.headers.set(key, value);\n    }\n    const allowOrigin = await findAllowOrigin(c.req.header(\"origin\") || \"\", c);\n    if (allowOrigin) {\n      set(\"Access-Control-Allow-Origin\", allowOrigin);\n    }\n    if (opts.credentials) {\n      set(\"Access-Control-Allow-Credentials\", \"true\");\n    }\n    if (opts.exposeHeaders?.length) {\n      set(\"Access-Control-Expose-Headers\", opts.exposeHeaders.join(\",\"));\n    }\n    if (c.req.method === \"OPTIONS\") {\n      if (opts.origin !== \"*\") {\n        set(\"Vary\", \"Origin\");\n      }\n      if (opts.maxAge != null) {\n        set(\"Access-Control-Max-Age\", opts.maxAge.toString());\n      }\n      const allowMethods = await findAllowMethods(c.req.header(\"origin\") || \"\", c);\n      if (allowMethods.length) {\n        set(\"Access-Control-Allow-Methods\", allowMethods.join(\",\"));\n      }\n      let headers = opts.allowHeaders;\n      if (!headers?.length) {\n        const requestHeaders = c.req.header(\"Access-Control-Request-Headers\");\n        if (requestHeaders) {\n          headers = requestHeaders.split(/\\s*,\\s*/);\n        }\n      }\n      if (headers?.length) {\n        set(\"Access-Control-Allow-Headers\", headers.join(\",\"));\n        c.res.headers.append(\"Vary\", \"Access-Control-Request-Headers\");\n      }\n      c.res.headers.delete(\"Content-Length\");\n      c.res.headers.delete(\"Content-Type\");\n      return new Response(null, {\n        headers: c.res.headers,\n        status: 204,\n        statusText: \"No Content\"\n      });\n    }\n    await next();\n    if (opts.origin !== \"*\") {\n      c.header(\"Vary\", \"Origin\", { append: true });\n    }\n  };\n};\nexport {\n  cors\n};\n", "// src/utils/color.ts\nfunction getColorEnabled() {\n  const { process, Deno } = globalThis;\n  const isNoColor = typeof Deno?.noColor === \"boolean\" ? Deno.noColor : process !== void 0 ? (\n    // eslint-disable-next-line no-unsafe-optional-chaining\n    \"NO_COLOR\" in process?.env\n  ) : false;\n  return !isNoColor;\n}\nasync function getColorEnabledAsync() {\n  const { navigator } = globalThis;\n  const cfWorkers = \"cloudflare:workers\";\n  const isNoColor = navigator !== void 0 && navigator.userAgent === \"Cloudflare-Workers\" ? await (async () => {\n    try {\n      return \"NO_COLOR\" in ((await import(cfWorkers)).env ?? {});\n    } catch {\n      return false;\n    }\n  })() : !getColorEnabled();\n  return !isNoColor;\n}\nexport {\n  getColorEnabled,\n  getColorEnabledAsync\n};\n", "// src/middleware/logger/index.ts\nimport { getColorEnabledAsync } from \"../../utils/color.js\";\nvar humanize = (times) => {\n  const [delimiter, separator] = [\",\", \".\"];\n  const orderTimes = times.map((v) => v.replace(/(\\d)(?=(\\d\\d\\d)+(?!\\d))/g, \"$1\" + delimiter));\n  return orderTimes.join(separator);\n};\nvar time = (start) => {\n  const delta = Date.now() - start;\n  return humanize([delta < 1e3 ? delta + \"ms\" : Math.round(delta / 1e3) + \"s\"]);\n};\nvar colorStatus = async (status) => {\n  const colorEnabled = await getColorEnabledAsync();\n  if (colorEnabled) {\n    switch (status / 100 | 0) {\n      case 5:\n        return `\\x1B[31m${status}\\x1B[0m`;\n      case 4:\n        return `\\x1B[33m${status}\\x1B[0m`;\n      case 3:\n        return `\\x1B[36m${status}\\x1B[0m`;\n      case 2:\n        return `\\x1B[32m${status}\\x1B[0m`;\n    }\n  }\n  return `${status}`;\n};\nasync function log(fn, prefix, method, path, status = 0, elapsed) {\n  const out = prefix === \"<--\" /* Incoming */ ? `${prefix} ${method} ${path}` : `${prefix} ${method} ${path} ${await colorStatus(status)} ${elapsed}`;\n  fn(out);\n}\nvar logger = (fn = console.log) => {\n  return async function logger2(c, next) {\n    const { method, url } = c.req;\n    const path = url.slice(url.indexOf(\"/\", 8));\n    await log(fn, \"<--\" /* Incoming */, method, path);\n    const start = Date.now();\n    await next();\n    await log(fn, \"-->\" /* Outgoing */, method, path, c.res.status, time(start));\n  };\n};\nexport {\n  logger\n};\n", "// src/middleware/pretty-json/index.ts\nvar prettyJSON = (options) => {\n  const targetQuery = options?.query ?? \"pretty\";\n  return async function prettyJSON2(c, next) {\n    const pretty = options?.force || c.req.query(targetQuery) || c.req.query(targetQuery) === \"\";\n    await next();\n    if (pretty && c.res.headers.get(\"Content-Type\")?.startsWith(\"application/json\")) {\n      const obj = await c.res.json();\n      c.res = new Response(JSON.stringify(obj, null, options?.space ?? 2), c.res);\n    }\n  };\n};\nexport {\n  prettyJSON\n};\n", "/**\r\n * D1 Database Service\r\n * Enterprise-grade database operations for Tamuu\r\n */\r\n\r\nimport type {\r\n    Env,\r\n    DBTemplate,\r\n    DBTemplateSection,\r\n    DBTemplateElement,\r\n    DBRSVPResponse,\r\n    TemplateResponse,\r\n    SectionDesign,\r\n    TemplateElement,\r\n    RSVPResponse as RSVPResponseType\r\n} from '../types';\r\n\r\n/**\r\n * Generate UUID v4\r\n */\r\nfunction generateUUID(): string {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\r\n        const r = Math.random() * 16 | 0;\r\n        const v = c === 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n}\r\n\r\n/**\r\n * Parse JSON safely\r\n */\r\nfunction safeParseJSON<T>(str: string | null, fallback: T): T {\r\n    if (!str) return fallback;\r\n    try {\r\n        return JSON.parse(str);\r\n    } catch {\r\n        return fallback;\r\n    }\r\n}\r\n\r\n/**\r\n * Database Service Class\r\n */\r\nexport class DatabaseService {\r\n    constructor(private db: D1Database) { }\r\n\r\n    // ============================================\r\n    // TEMPLATES\r\n    // ============================================\r\n\r\n    /**\r\n     * Get all templates (list view - minimal data)\r\n     */\r\n    async getTemplates(): Promise<TemplateResponse[]> {\r\n        const results = await this.db\r\n            .prepare(`\r\n        SELECT id, name, thumbnail, status, updated_at, created_at\r\n        FROM templates\r\n        ORDER BY updated_at DESC\r\n        LIMIT 50\r\n      `)\r\n            .all<DBTemplate>();\r\n\r\n        return (results.results || []).map((t) => ({\r\n            id: t.id,\r\n            name: t.name,\r\n            thumbnail: t.thumbnail,\r\n            status: t.status,\r\n            sections: {},\r\n            sectionOrder: [],\r\n            customSections: [],\r\n            globalTheme: {\r\n                id: 'default',\r\n                name: 'Default',\r\n                category: 'modern',\r\n                colors: {\r\n                    primary: '#000000',\r\n                    secondary: '#ffffff',\r\n                    accent: '#000000',\r\n                    background: '#ffffff',\r\n                    text: '#000000',\r\n                },\r\n                fontFamily: 'Inter',\r\n            },\r\n            createdAt: t.created_at,\r\n            updatedAt: t.updated_at,\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Get single template with full data (sections + elements)\r\n     */\r\n    async getTemplate(id: string): Promise<TemplateResponse | null> {\r\n        // Fetch template\r\n        const template = await this.db\r\n            .prepare('SELECT * FROM templates WHERE id = ?')\r\n            .bind(id)\r\n            .first<DBTemplate>();\r\n\r\n        if (!template) return null;\r\n\r\n        // Fetch sections\r\n        const sectionsResult = await this.db\r\n            .prepare('SELECT * FROM template_sections WHERE template_id = ?')\r\n            .bind(id)\r\n            .all<DBTemplateSection>();\r\n\r\n        const sections = sectionsResult.results || [];\r\n        const sectionIds = sections.map((s) => s.id);\r\n\r\n        // Fetch all elements for all sections in one query\r\n        let allElements: DBTemplateElement[] = [];\r\n        if (sectionIds.length > 0) {\r\n            const placeholders = sectionIds.map(() => '?').join(',');\r\n            const elementsResult = await this.db\r\n                .prepare(`SELECT * FROM template_elements WHERE section_id IN (${placeholders})`)\r\n                .bind(...sectionIds)\r\n                .all<DBTemplateElement>();\r\n            allElements = elementsResult.results || [];\r\n        }\r\n\r\n        // Group elements by section_id\r\n        const elementsBySection: Record<string, DBTemplateElement[]> = {};\r\n        allElements.forEach((el) => {\r\n            if (!elementsBySection[el.section_id]) {\r\n                elementsBySection[el.section_id] = [];\r\n            }\r\n            elementsBySection[el.section_id].push(el);\r\n        });\r\n\r\n        // Build sections map\r\n        const sectionOrder = safeParseJSON<string[]>(template.section_order, []);\r\n        const finalSections: Record<string, SectionDesign> = {};\r\n\r\n        sections.forEach((section) => {\r\n            const sectionElements = elementsBySection[section.id] || [];\r\n            let order = sectionOrder.indexOf(section.type);\r\n            if (order === -1) order = 999;\r\n\r\n            finalSections[section.type] = {\r\n                id: section.id,\r\n                isVisible: section.is_visible === 1,\r\n                backgroundColor: section.background_color || undefined,\r\n                backgroundUrl: section.background_url || undefined,\r\n                overlayOpacity: section.overlay_opacity,\r\n                animation: section.animation,\r\n                pageTitle: section.page_title || undefined,\r\n                title: section.page_title || undefined,\r\n                order,\r\n                openInvitationConfig: safeParseJSON(section.open_invitation_config, undefined),\r\n                animationTrigger: (section.animation_trigger as any) || 'scroll',\r\n                transitionEffect: (section.transition_effect as string) || 'none',\r\n                transitionDuration: (section.transition_duration as number) || 1000,\r\n                transitionTrigger: (section.transition_trigger as any) || 'scroll',\r\n                particleType: (section.particle_type as any) || 'none',\r\n                kenBurnsEnabled: section.ken_burns_enabled === 1,\r\n                zoomConfig: safeParseJSON(section.zoom_config, undefined),\r\n                pageTransition: safeParseJSON(section.page_transition, undefined),\r\n                elements: sectionElements.map((el) => this.mapElementToResponse(el)),\r\n            };\r\n        });\r\n\r\n        return {\r\n            id: template.id,\r\n            name: template.name,\r\n            thumbnail: template.thumbnail,\r\n            status: template.status,\r\n            sections: finalSections,\r\n            sectionOrder,\r\n            customSections: safeParseJSON(template.custom_sections, []),\r\n            globalTheme: safeParseJSON(template.global_theme, {\r\n                id: 'default',\r\n                name: 'Default',\r\n                category: 'modern',\r\n                colors: {\r\n                    primary: '#000000',\r\n                    secondary: '#ffffff',\r\n                    accent: '#000000',\r\n                    background: '#ffffff',\r\n                    text: '#000000',\r\n                },\r\n                fontFamily: 'Inter',\r\n            }),\r\n            eventDate: template.event_date || undefined,\r\n            createdAt: template.created_at,\r\n            updatedAt: template.updated_at,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Create new template\r\n     */\r\n    async createTemplate(data: Partial<TemplateResponse>): Promise<TemplateResponse> {\r\n        const id = generateUUID();\r\n        const now = new Date().toISOString();\r\n\r\n        await this.db\r\n            .prepare(`\r\n        INSERT INTO templates (id, name, thumbnail, status, section_order, custom_sections, global_theme, event_date, created_at, updated_at)\r\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n      `)\r\n            .bind(\r\n                id,\r\n                data.name || 'Untitled Template',\r\n                data.thumbnail || null,\r\n                data.status || 'draft',\r\n                JSON.stringify(data.sectionOrder || []),\r\n                JSON.stringify(data.customSections || []),\r\n                JSON.stringify(data.globalTheme || {}),\r\n                data.eventDate || null,\r\n                now,\r\n                now\r\n            )\r\n            .run();\r\n\r\n        // Create initial sections if provided\r\n        if (data.sections) {\r\n            for (const [type, design] of Object.entries(data.sections)) {\r\n                await this.upsertSection(id, type, design);\r\n            }\r\n        }\r\n\r\n        return (await this.getTemplate(id))!;\r\n    }\r\n\r\n    /**\r\n     * Update template\r\n     */\r\n    async updateTemplate(id: string, updates: Partial<TemplateResponse>): Promise<void> {\r\n        const now = new Date().toISOString();\r\n\r\n        const sets: string[] = ['updated_at = ?'];\r\n        const values: unknown[] = [now];\r\n\r\n        if (updates.name !== undefined) {\r\n            sets.push('name = ?');\r\n            values.push(updates.name);\r\n        }\r\n        if (updates.thumbnail !== undefined) {\r\n            sets.push('thumbnail = ?');\r\n            values.push(updates.thumbnail);\r\n        }\r\n        if (updates.status !== undefined) {\r\n            sets.push('status = ?');\r\n            values.push(updates.status);\r\n        }\r\n        if (updates.sectionOrder !== undefined) {\r\n            sets.push('section_order = ?');\r\n            values.push(JSON.stringify(updates.sectionOrder));\r\n        }\r\n        if (updates.customSections !== undefined) {\r\n            sets.push('custom_sections = ?');\r\n            values.push(JSON.stringify(updates.customSections));\r\n        }\r\n        if (updates.globalTheme !== undefined) {\r\n            sets.push('global_theme = ?');\r\n            values.push(JSON.stringify(updates.globalTheme));\r\n        }\r\n        if (updates.eventDate !== undefined) {\r\n            sets.push('event_date = ?');\r\n            values.push(updates.eventDate);\r\n        }\r\n\r\n        values.push(id);\r\n\r\n        await this.db\r\n            .prepare(`UPDATE templates SET ${sets.join(', ')} WHERE id = ?`)\r\n            .bind(...values)\r\n            .run();\r\n    }\r\n\r\n    /**\r\n     * Delete template (cascades to sections and elements)\r\n     */\r\n    async deleteTemplate(id: string): Promise<void> {\r\n        await this.db\r\n            .prepare('DELETE FROM templates WHERE id = ?')\r\n            .bind(id)\r\n            .run();\r\n    }\r\n\r\n    // ============================================\r\n    // SECTIONS\r\n    // ============================================\r\n\r\n    /**\r\n     * Upsert section (create or update)\r\n     */\r\n    async upsertSection(templateId: string, sectionType: string, updates: Partial<SectionDesign>): Promise<string> {\r\n        // Check if section exists\r\n        const existing = await this.db\r\n            .prepare('SELECT id FROM template_sections WHERE template_id = ? AND type = ?')\r\n            .bind(templateId, sectionType)\r\n            .first<{ id: string }>();\r\n\r\n        const now = new Date().toISOString();\r\n\r\n        if (existing) {\r\n            // Update existing section - DYNAMIC UPDATE to prevent overwriting missing fields\r\n            const sets: string[] = ['updated_at = ?'];\r\n            const values: any[] = [now];\r\n\r\n            if (updates.isVisible !== undefined) {\r\n                sets.push('is_visible = ?');\r\n                values.push(updates.isVisible ? 1 : 0);\r\n            }\r\n            if (updates.backgroundColor !== undefined) {\r\n                sets.push('background_color = ?');\r\n                values.push(updates.backgroundColor || null);\r\n            }\r\n            if (updates.backgroundUrl !== undefined) {\r\n                sets.push('background_url = ?');\r\n                values.push(updates.backgroundUrl || null);\r\n            }\r\n            if (updates.overlayOpacity !== undefined) {\r\n                sets.push('overlay_opacity = ?');\r\n                values.push(updates.overlayOpacity);\r\n            }\r\n            if (updates.animation !== undefined) {\r\n                sets.push('animation = ?');\r\n                values.push(updates.animation);\r\n            }\r\n            if (updates.pageTitle !== undefined) {\r\n                sets.push('page_title = ?');\r\n                values.push(updates.pageTitle || null);\r\n            }\r\n            if (updates.animationTrigger !== undefined) {\r\n                sets.push('animation_trigger = ?');\r\n                values.push(updates.animationTrigger);\r\n            }\r\n            if (updates.openInvitationConfig !== undefined) {\r\n                sets.push('open_invitation_config = ?');\r\n                values.push(JSON.stringify(updates.openInvitationConfig));\r\n            }\r\n            if (updates.transitionEffect !== undefined) {\r\n                sets.push('transition_effect = ?');\r\n                values.push(updates.transitionEffect);\r\n            }\r\n            if (updates.transitionDuration !== undefined) {\r\n                sets.push('transition_duration = ?');\r\n                values.push(updates.transitionDuration);\r\n            }\r\n            if (updates.transitionTrigger !== undefined) {\r\n                sets.push('transition_trigger = ?');\r\n                values.push(updates.transitionTrigger);\r\n            }\r\n            if (updates.particleType !== undefined) {\r\n                sets.push('particle_type = ?');\r\n                values.push(updates.particleType);\r\n            }\r\n            if (updates.kenBurnsEnabled !== undefined) {\r\n                sets.push('ken_burns_enabled = ?');\r\n                values.push(updates.kenBurnsEnabled ? 1 : 0);\r\n            }\r\n            if (updates.zoomConfig !== undefined) {\r\n                console.log(`[Database] Updating zoom_config for ${sectionType}:`, JSON.stringify(updates.zoomConfig));\r\n                sets.push('zoom_config = ?');\r\n                values.push(updates.zoomConfig ? JSON.stringify(updates.zoomConfig) : null);\r\n            }\r\n            if (updates.pageTransition !== undefined) {\r\n                console.log(`[Database] Updating page_transition for ${sectionType}:`, JSON.stringify(updates.pageTransition));\r\n                sets.push('page_transition = ?');\r\n                values.push(updates.pageTransition ? JSON.stringify(updates.pageTransition) : null);\r\n            }\r\n\r\n            if (sets.length > 1) {\r\n                const query = `UPDATE template_sections SET ${sets.join(', ')} WHERE id = ?`;\r\n                console.log(`[Database] Executing UPDATE query for section ${existing.id}`);\r\n                await this.db.prepare(query).bind(...values, existing.id).run();\r\n                console.log(`[Database] UPDATE SUCCESS for section ${existing.id}`);\r\n            } else {\r\n                console.log(`[Database] No updates needed for section ${existing.id}`);\r\n            }\r\n\r\n            return existing.id;\r\n        } else {\r\n            // Create new section\r\n            const id = generateUUID();\r\n            await this.db\r\n                .prepare(`\r\n          INSERT INTO template_sections (\r\n            id, template_id, type, is_visible, background_color, background_url, \r\n            overlay_opacity, animation, page_title, animation_trigger, \r\n            open_invitation_config, transition_effect, transition_duration, transition_trigger,\r\n            particle_type, ken_burns_enabled, zoom_config, page_transition,\r\n            created_at, updated_at\r\n          )\r\n          VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n        `)\r\n                .bind(\r\n                    id,\r\n                    templateId,\r\n                    sectionType,\r\n                    updates.isVisible !== undefined ? (updates.isVisible ? 1 : 0) : 1,\r\n                    updates.backgroundColor || null,\r\n                    updates.backgroundUrl || null,\r\n                    updates.overlayOpacity ?? 0,\r\n                    updates.animation || 'fade-in',\r\n                    updates.pageTitle || null,\r\n                    updates.animationTrigger || 'scroll',\r\n                    updates.openInvitationConfig ? JSON.stringify(updates.openInvitationConfig) : null,\r\n                    updates.transitionEffect || 'none',\r\n                    updates.transitionDuration || 1000,\r\n                    updates.transitionTrigger || 'scroll',\r\n                    updates.particleType || 'none',\r\n                    updates.kenBurnsEnabled ? 1 : 0,\r\n                    updates.zoomConfig ? JSON.stringify(updates.zoomConfig) : null,\r\n                    updates.pageTransition ? JSON.stringify(updates.pageTransition) : null,\r\n                    now,\r\n                    now\r\n                )\r\n                .run();\r\n\r\n            return id;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Delete section\r\n     */\r\n    async deleteSection(templateId: string, sectionType: string): Promise<void> {\r\n        await this.db\r\n            .prepare('DELETE FROM template_sections WHERE template_id = ? AND type = ?')\r\n            .bind(templateId, sectionType)\r\n            .run();\r\n    }\r\n\r\n    /**\r\n     * Get section ID by template and type\r\n     */\r\n    async getSectionId(templateId: string, sectionType: string): Promise<string | null> {\r\n        const result = await this.db\r\n            .prepare('SELECT id FROM template_sections WHERE template_id = ? AND type = ?')\r\n            .bind(templateId, sectionType)\r\n            .first<{ id: string }>();\r\n\r\n        return result?.id || null;\r\n    }\r\n\r\n    // ============================================\r\n    // ELEMENTS\r\n    // ============================================\r\n\r\n    /**\r\n     * Create element\r\n     */\r\n    async createElement(sectionId: string, element: Partial<TemplateElement>): Promise<TemplateElement> {\r\n        const id = element.id?.startsWith('el-') ? generateUUID() : (element.id || generateUUID());\r\n        const now = new Date().toISOString();\r\n\r\n        await this.db\r\n            .prepare(`\r\n        INSERT INTO template_elements (\r\n          id, section_id, type, name, position_x, position_y, width, height, z_index,\r\n          animation, loop_animation, animation_delay, animation_speed, animation_duration, animation_trigger, animation_loop,\r\n          content, image_url, text_style, icon_style, countdown_config,\r\n          rsvp_form_config, guest_wishes_config, open_invitation_config,\r\n          rotation, flip_horizontal, flip_vertical, motion_path_config,\r\n          can_edit_position, can_edit_content, is_content_protected, show_copy_button,\r\n          lottie_config, created_at, updated_at\r\n        )\r\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n      `)\r\n            .bind(\r\n                id,\r\n                sectionId,\r\n                element.type || 'text',\r\n                element.name || 'Element',\r\n                element.position?.x ?? 0,\r\n                element.position?.y ?? 0,\r\n                element.size?.width ?? 100,\r\n                element.size?.height ?? 100,\r\n                element.zIndex ?? 0,\r\n                element.animation || 'fade-in',\r\n                element.loopAnimation || null,\r\n                element.animationDelay ?? 0,\r\n                element.animationSpeed ?? 500,\r\n                element.animationDuration ?? 1000,\r\n                element.animationTrigger || 'scroll',\r\n                element.animationLoop ? 1 : 0,\r\n                element.content || null,\r\n                element.imageUrl || null,\r\n                element.textStyle ? JSON.stringify(element.textStyle) : null,\r\n                element.iconStyle ? JSON.stringify(element.iconStyle) : null,\r\n                element.countdownConfig ? JSON.stringify(element.countdownConfig) : null,\r\n                element.rsvpFormConfig ? JSON.stringify(element.rsvpFormConfig) : null,\r\n                element.guestWishesConfig ? JSON.stringify(element.guestWishesConfig) : null,\r\n                element.openInvitationConfig ? JSON.stringify(element.openInvitationConfig) : null,\r\n                element.rotation ?? 0,\r\n                element.flipHorizontal ? 1 : 0,\r\n                element.flipVertical ? 1 : 0,\r\n                element.motionPathConfig ? JSON.stringify(element.motionPathConfig) : null,\r\n                element.canEditPosition ? 1 : 0,\r\n                element.canEditContent ? 1 : 0,\r\n                element.isContentProtected ? 1 : 0,\r\n                element.showCopyButton ? 1 : 0,\r\n                element.lottieConfig ? JSON.stringify(element.lottieConfig) : null,\r\n                now,\r\n                now\r\n            )\r\n            .run();\r\n\r\n        const created = await this.db\r\n            .prepare('SELECT * FROM template_elements WHERE id = ?')\r\n            .bind(id)\r\n            .first<DBTemplateElement>();\r\n\r\n        return this.mapElementToResponse(created!);\r\n    }\r\n\r\n    /**\r\n     * Update element\r\n     */\r\n    async updateElement(elementId: string, updates: Partial<TemplateElement>): Promise<void> {\r\n        const now = new Date().toISOString();\r\n        const sets: string[] = ['updated_at = ?'];\r\n        const values: unknown[] = [now];\r\n\r\n        if (updates.name !== undefined) {\r\n            sets.push('\"name\" = ?');\r\n            values.push(updates.name);\r\n        }\r\n        if (updates.position !== undefined) {\r\n            sets.push('\"position_x\" = ?, \"position_y\" = ?');\r\n            values.push(updates.position.x, updates.position.y);\r\n        }\r\n        if (updates.size !== undefined) {\r\n            sets.push('\"width\" = ?, \"height\" = ?');\r\n            values.push(updates.size.width, updates.size.height);\r\n        }\r\n        if (updates.zIndex !== undefined) {\r\n            sets.push('\"z_index\" = ?');\r\n            values.push(updates.zIndex);\r\n        }\r\n        if (updates.animation !== undefined) {\r\n            sets.push('\"animation\" = ?');\r\n            values.push(updates.animation);\r\n        }\r\n        if (updates.loopAnimation !== undefined) {\r\n            sets.push('\"loop_animation\" = ?');\r\n            values.push(updates.loopAnimation || null);\r\n        }\r\n        if (updates.animationDelay !== undefined) {\r\n            sets.push('\"animation_delay\" = ?');\r\n            values.push(updates.animationDelay);\r\n        }\r\n        if (updates.animationSpeed !== undefined) {\r\n            sets.push('\"animation_speed\" = ?');\r\n            values.push(updates.animationSpeed);\r\n        }\r\n        if (updates.animationDuration !== undefined) {\r\n            sets.push('\"animation_duration\" = ?');\r\n            values.push(updates.animationDuration);\r\n        }\r\n        if (updates.animationTrigger !== undefined) {\r\n            sets.push('\"animation_trigger\" = ?');\r\n            values.push(updates.animationTrigger);\r\n        }\r\n\r\n        if (updates.content !== undefined) {\r\n            sets.push('\"content\" = ?');\r\n            values.push(updates.content || null);\r\n        }\r\n        if (updates.imageUrl !== undefined) {\r\n            sets.push('\"image_url\" = ?');\r\n            values.push(updates.imageUrl || null);\r\n        }\r\n        if (updates.textStyle !== undefined) {\r\n            sets.push('\"text_style\" = ?');\r\n            values.push(JSON.stringify(updates.textStyle));\r\n        }\r\n        if (updates.iconStyle !== undefined) {\r\n            sets.push('\"icon_style\" = ?');\r\n            values.push(JSON.stringify(updates.iconStyle));\r\n        }\r\n        if (updates.countdownConfig !== undefined) {\r\n            sets.push('\"countdown_config\" = ?');\r\n            values.push(JSON.stringify(updates.countdownConfig));\r\n        }\r\n        if (updates.rsvpFormConfig !== undefined) {\r\n            sets.push('\"rsvp_form_config\" = ?');\r\n            values.push(JSON.stringify(updates.rsvpFormConfig));\r\n        }\r\n        if (updates.guestWishesConfig !== undefined) {\r\n            sets.push('\"guest_wishes_config\" = ?');\r\n            values.push(JSON.stringify(updates.guestWishesConfig));\r\n        }\r\n        if (updates.openInvitationConfig !== undefined) {\r\n            sets.push('\"open_invitation_config\" = ?');\r\n            values.push(JSON.stringify(updates.openInvitationConfig));\r\n        }\r\n        if (updates.rotation !== undefined) {\r\n            sets.push('\"rotation\" = ?');\r\n            values.push(updates.rotation);\r\n        }\r\n        if (updates.flipHorizontal !== undefined) {\r\n            sets.push('\"flip_horizontal\" = ?');\r\n            values.push(updates.flipHorizontal ? 1 : 0);\r\n        }\r\n        if (updates.flipVertical !== undefined) {\r\n            sets.push('\"flip_vertical\" = ?');\r\n            values.push(updates.flipVertical ? 1 : 0);\r\n        }\r\n        if (updates.motionPathConfig !== undefined) {\r\n            sets.push('\"motion_path_config\" = ?');\r\n            values.push(updates.motionPathConfig ? JSON.stringify(updates.motionPathConfig) : null);\r\n        }\r\n        if (updates.parallaxFactor !== undefined) {\r\n            sets.push('\"parallax_factor\" = ?');\r\n            values.push(updates.parallaxFactor);\r\n        }\r\n\r\n        // Permissions\r\n        if (updates.canEditPosition !== undefined) {\r\n            sets.push('\"can_edit_position\" = ?');\r\n            values.push(updates.canEditPosition ? 1 : 0);\r\n        }\r\n        if (updates.canEditContent !== undefined) {\r\n            sets.push('\"can_edit_content\" = ?');\r\n            values.push(updates.canEditContent ? 1 : 0);\r\n        }\r\n        if (updates.isContentProtected !== undefined) {\r\n            sets.push('\"is_content_protected\" = ?');\r\n            values.push(updates.isContentProtected ? 1 : 0);\r\n        }\r\n        if (updates.showCopyButton !== undefined) {\r\n            sets.push('\"show_copy_button\" = ?');\r\n            values.push(updates.showCopyButton ? 1 : 0);\r\n        }\r\n\r\n        // Lottie Animation\r\n        if (updates.lottieConfig !== undefined) {\r\n            sets.push('\"lottie_config\" = ?');\r\n            values.push(updates.lottieConfig ? JSON.stringify(updates.lottieConfig) : null);\r\n        }\r\n\r\n        // Animation Loop\r\n        if (updates.animationLoop !== undefined) {\r\n            sets.push('\"animation_loop\" = ?');\r\n            values.push(updates.animationLoop ? 1 : 0);\r\n        }\r\n\r\n        // Move \"No Updates\" check to after all possible property processing\r\n        if (sets.length === 1 && sets[0] === 'updated_at = ?') return;\r\n\r\n        values.push(elementId);\r\n\r\n        const query = `UPDATE template_elements SET ${sets.join(', ')} WHERE id = ?`;\r\n        console.log(`[DB SERVICE] Updating element ${elementId} with query:`, query);\r\n        console.log(`[DB SERVICE] Values:`, values);\r\n\r\n        await this.db\r\n            .prepare(query)\r\n            .bind(...values)\r\n            .run();\r\n    }\r\n\r\n    /**\r\n     * Get single element by ID\r\n     * Used for cleanup operations\r\n     */\r\n    async getElement(elementId: string): Promise<TemplateElement | null> {\r\n        const result = await this.db\r\n            .prepare('SELECT * FROM template_elements WHERE id = ?')\r\n            .bind(elementId)\r\n            .first<DBTemplateElement>();\r\n\r\n        if (!result) return null;\r\n        return this.mapElementToResponse(result);\r\n    }\r\n\r\n    /**\r\n     * Delete element\r\n     */\r\n    async deleteElement(elementId: string): Promise<void> {\r\n        await this.db\r\n            .prepare('DELETE FROM template_elements WHERE id = ?')\r\n            .bind(elementId)\r\n            .run();\r\n    }\r\n\r\n    // ============================================\r\n    // RSVP\r\n    // ============================================\r\n\r\n    /**\r\n     * Submit RSVP response\r\n     */\r\n    async submitRSVP(templateId: string, data: Partial<RSVPResponseType>): Promise<RSVPResponseType> {\r\n        const id = generateUUID();\r\n        const now = new Date().toISOString();\r\n\r\n        await this.db\r\n            .prepare(`\r\n        INSERT INTO rsvp_responses (id, template_id, name, email, phone, message, attendance, is_public, created_at)\r\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n      `)\r\n            .bind(\r\n                id,\r\n                templateId,\r\n                data.name || 'Guest',\r\n                data.email || null,\r\n                data.phone || null,\r\n                data.message || null,\r\n                data.attendance || null,\r\n                data.isPublic !== false ? 1 : 0,\r\n                now\r\n            )\r\n            .run();\r\n\r\n        return {\r\n            id,\r\n            templateId,\r\n            name: data.name || 'Guest',\r\n            email: data.email,\r\n            phone: data.phone,\r\n            message: data.message || '',\r\n            attendance: data.attendance,\r\n            isPublic: data.isPublic !== false,\r\n            createdAt: now,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Get RSVP responses for template\r\n     */\r\n    async getRSVPResponses(templateId: string): Promise<RSVPResponseType[]> {\r\n        const results = await this.db\r\n            .prepare(`\r\n        SELECT * FROM rsvp_responses\r\n        WHERE template_id = ?\r\n        ORDER BY created_at DESC\r\n      `)\r\n            .bind(templateId)\r\n            .all<DBRSVPResponse>();\r\n\r\n        return (results.results || []).map((r) => ({\r\n            id: r.id,\r\n            templateId: r.template_id,\r\n            name: r.name,\r\n            email: r.email || undefined,\r\n            phone: r.phone || undefined,\r\n            message: r.message || '',\r\n            attendance: r.attendance || undefined,\r\n            isPublic: r.is_public === 1,\r\n            createdAt: r.created_at,\r\n        }));\r\n    }\r\n\r\n    // ============================================\r\n    // HELPERS\r\n    // ============================================\r\n\r\n    /**\r\n     * Map DB element to API response\r\n     */\r\n    private mapElementToResponse(el: DBTemplateElement): TemplateElement {\r\n        return {\r\n            id: el.id,\r\n            type: el.type,\r\n            name: el.name,\r\n            position: { x: el.position_x, y: el.position_y },\r\n            size: { width: el.width, height: el.height },\r\n            zIndex: el.z_index,\r\n            animation: el.animation,\r\n            loopAnimation: el.loop_animation || undefined,\r\n            animationDelay: el.animation_delay,\r\n            animationSpeed: el.animation_speed,\r\n            animationDuration: el.animation_duration,\r\n            animationTrigger: (el.animation_trigger || 'scroll') as 'scroll' | 'click' | 'open_btn',\r\n            animationLoop: el.animation_loop === 1,\r\n            content: el.content || undefined,\r\n            imageUrl: el.image_url || undefined,\r\n            textStyle: safeParseJSON(el.text_style, undefined),\r\n            iconStyle: safeParseJSON(el.icon_style, undefined),\r\n            countdownConfig: safeParseJSON(el.countdown_config, undefined),\r\n            rsvpFormConfig: safeParseJSON(el.rsvp_form_config, undefined),\r\n            guestWishesConfig: safeParseJSON(el.guest_wishes_config, undefined),\r\n            openInvitationConfig: safeParseJSON(el.open_invitation_config, undefined),\r\n            rotation: el.rotation,\r\n            flipHorizontal: el.flip_horizontal === 1,\r\n            flipVertical: el.flip_vertical === 1,\r\n            motionPathConfig: safeParseJSON(el.motion_path_config, undefined),\r\n            parallaxFactor: el.parallax_factor || 0,\r\n\r\n            // Permissions\r\n            canEditPosition: el.can_edit_position === 1,\r\n            canEditContent: el.can_edit_content === 1,\r\n            isContentProtected: el.is_content_protected === 1,\r\n            showCopyButton: el.show_copy_button === 1,\r\n\r\n            // Lottie Animation\r\n            lottieConfig: safeParseJSON(el.lottie_config, undefined),\r\n        };\r\n    }\r\n}\r\n", "/**\r\n * KV Cache Service\r\n * Enterprise-grade caching for Tamuu API\r\n * OPTIMIZED FOR 10,000 USERS/MONTH - FREE TIER\r\n * \r\n * Features:\r\n * - Stale-while-revalidate pattern\r\n * - Status-aware TTL (published vs draft)\r\n * - Public view caching (48 hours for guests)\r\n * - Cache hit tracking\r\n */\r\n\r\nimport type { TemplateResponse } from '../types';\r\n\r\n// Cache TTL values (in seconds) - OPTIMIZED FOR FREE TIER\r\nconst CACHE_TTL = {\r\n    // Published templates - aggressive caching (rarely change after publish)\r\n    TEMPLATE_PUBLISHED: 86400,  // 24 hours\r\n\r\n    // Draft templates - shorter for editor experience\r\n    TEMPLATE_DRAFT: 60,         // 1 minute\r\n\r\n    // Templates list - medium\r\n    TEMPLATES_LIST: 600,        // 10 minutes\r\n\r\n    // RSVP data - shorter for freshness\r\n    RSVP: 120,                  // 2 minutes\r\n\r\n    // Public invitation view - very aggressive (guests see cached version)\r\n    PUBLIC_VIEW: 172800,        // 48 hours\r\n\r\n    // Stale time - how long to serve stale data while revalidating in background\r\n    STALE_WHILE_REVALIDATE: 86400,  // 24 hours stale is acceptable\r\n} as const;\r\n\r\n// Cache key prefixes\r\nconst CACHE_KEYS = {\r\n    TEMPLATE: 'template:',\r\n    TEMPLATE_PUBLIC: 'public:',\r\n    TEMPLATES_LIST: 'templates:list',\r\n    RSVP: 'rsvp:',\r\n    STATS: 'stats:',\r\n} as const;\r\n\r\n// Metadata interface for stale-while-revalidate\r\ninterface CacheMetadata {\r\n    cachedAt: number;\r\n    status?: 'draft' | 'published';\r\n    version?: number;\r\n}\r\n\r\n// Cache result with SWR info\r\ninterface CacheResultWithSWR<T> {\r\n    value: T | null;\r\n    isStale: boolean;\r\n    needsRevalidation: boolean;\r\n}\r\n\r\n/**\r\n * Cache Service Class\r\n */\r\nexport class CacheService {\r\n    constructor(private kv: KVNamespace) { }\r\n\r\n    // ============================================\r\n    // STALE-WHILE-REVALIDATE PATTERN\r\n    // ============================================\r\n\r\n    /**\r\n     * Get with stale-while-revalidate support\r\n     * Returns data immediately (even if stale), indicates if revalidation needed\r\n     */\r\n    async getWithSWR<T>(key: string, freshTtl: number): Promise<CacheResultWithSWR<T>> {\r\n        try {\r\n            const { value, metadata } = await this.kv.getWithMetadata<T, CacheMetadata>(key, 'json');\r\n\r\n            if (!value) {\r\n                return { value: null, isStale: false, needsRevalidation: false };\r\n            }\r\n\r\n            const cachedAt = metadata?.cachedAt || 0;\r\n            const age = (Date.now() - cachedAt) / 1000;\r\n            const isStale = age > freshTtl;\r\n            const needsRevalidation = isStale && age < CACHE_TTL.STALE_WHILE_REVALIDATE;\r\n\r\n            return { value, isStale, needsRevalidation };\r\n        } catch {\r\n            return { value: null, isStale: false, needsRevalidation: false };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set with metadata for SWR tracking\r\n     */\r\n    async setWithMetadata<T>(\r\n        key: string,\r\n        value: T,\r\n        ttl: number,\r\n        metadata: Partial<CacheMetadata> = {}\r\n    ): Promise<void> {\r\n        try {\r\n            await this.kv.put(key, JSON.stringify(value), {\r\n                expirationTtl: ttl + CACHE_TTL.STALE_WHILE_REVALIDATE, // Total TTL includes stale period\r\n                metadata: {\r\n                    cachedAt: Date.now(),\r\n                    ...metadata,\r\n                },\r\n            });\r\n        } catch (err) {\r\n            console.error('Cache set failed:', err);\r\n        }\r\n    }\r\n\r\n    // ============================================\r\n    // TEMPLATE CACHING (OPTIMIZED WITH SWR)\r\n    // ============================================\r\n\r\n    /**\r\n     * Get cached template with SWR support\r\n     */\r\n    async getTemplate(id: string): Promise<CacheResultWithSWR<TemplateResponse>> {\r\n        const result = await this.getWithSWR<TemplateResponse>(\r\n            `${CACHE_KEYS.TEMPLATE}${id}`,\r\n            CACHE_TTL.TEMPLATE_DRAFT // Use shorter TTL for freshness check\r\n        );\r\n        return {\r\n            value: result.value,\r\n            isStale: result.isStale,\r\n            needsRevalidation: result.needsRevalidation,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Cache template with status-aware TTL\r\n     * Published templates get longer TTL (24h) vs draft (1 min)\r\n     */\r\n    async setTemplate(id: string, template: TemplateResponse): Promise<void> {\r\n        const ttl = template.status === 'published'\r\n            ? CACHE_TTL.TEMPLATE_PUBLISHED\r\n            : CACHE_TTL.TEMPLATE_DRAFT;\r\n\r\n        await this.setWithMetadata(\r\n            `${CACHE_KEYS.TEMPLATE}${id}`,\r\n            template,\r\n            ttl,\r\n            { status: template.status as 'draft' | 'published' }\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Invalidate template cache\r\n     * OPTIMIZED: No longer auto-invalidates templates list to save KV delete operations\r\n     * Call invalidateTemplatesList() separately only when truly needed (create/delete template)\r\n     */\r\n    async invalidateTemplate(id: string): Promise<void> {\r\n        try {\r\n            await this.kv.delete(`${CACHE_KEYS.TEMPLATE}${id}`);\r\n            // NOTE: Removed auto-invalidation of templates list to save delete operations\r\n            // Templates list has 10-min TTL and will refresh naturally\r\n        } catch (err) {\r\n            console.error('Failed to invalidate template cache:', err);\r\n        }\r\n    }\r\n\r\n    // ============================================\r\n    // PUBLIC VIEW CACHING (ULTRA AGGRESSIVE - 48 HOURS)\r\n    // For guest access - they rarely need fresh data\r\n    // ============================================\r\n\r\n    /**\r\n     * Get cached public invitation view\r\n     * Used by guests - longest cache TTL\r\n     */\r\n    async getPublicView(templateId: string): Promise<TemplateResponse | null> {\r\n        try {\r\n            const cached = await this.kv.get(`${CACHE_KEYS.TEMPLATE_PUBLIC}${templateId}`, 'json');\r\n            return cached as TemplateResponse | null;\r\n        } catch {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Cache public view - 48 hours TTL\r\n     */\r\n    async setPublicView(templateId: string, template: TemplateResponse): Promise<void> {\r\n        try {\r\n            await this.kv.put(\r\n                `${CACHE_KEYS.TEMPLATE_PUBLIC}${templateId}`,\r\n                JSON.stringify(template),\r\n                { expirationTtl: CACHE_TTL.PUBLIC_VIEW }\r\n            );\r\n        } catch (err) {\r\n            console.error('Failed to cache public view:', err);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Invalidate public view when template is updated\r\n     */\r\n    async invalidatePublicView(templateId: string): Promise<void> {\r\n        try {\r\n            await this.kv.delete(`${CACHE_KEYS.TEMPLATE_PUBLIC}${templateId}`);\r\n        } catch (err) {\r\n            console.error('Failed to invalidate public view:', err);\r\n        }\r\n    }\r\n\r\n    // ============================================\r\n    // TEMPLATES LIST CACHING\r\n    // ============================================\r\n\r\n    /**\r\n     * Get cached templates list\r\n     */\r\n    async getTemplatesList(): Promise<TemplateResponse[] | null> {\r\n        try {\r\n            const cached = await this.kv.get(CACHE_KEYS.TEMPLATES_LIST, 'json');\r\n            return cached as TemplateResponse[] | null;\r\n        } catch {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Cache templates list\r\n     */\r\n    async setTemplatesList(templates: TemplateResponse[]): Promise<void> {\r\n        try {\r\n            await this.kv.put(\r\n                CACHE_KEYS.TEMPLATES_LIST,\r\n                JSON.stringify(templates),\r\n                { expirationTtl: CACHE_TTL.TEMPLATES_LIST }\r\n            );\r\n        } catch (err) {\r\n            console.error('Failed to cache templates list:', err);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Invalidate templates list cache\r\n     */\r\n    async invalidateTemplatesList(): Promise<void> {\r\n        try {\r\n            await this.kv.delete(CACHE_KEYS.TEMPLATES_LIST);\r\n        } catch (err) {\r\n            console.error('Failed to invalidate templates list cache:', err);\r\n        }\r\n    }\r\n\r\n    // ============================================\r\n    // RSVP CACHING\r\n    // ============================================\r\n\r\n    /**\r\n     * Get cached RSVP responses\r\n     */\r\n    async getRSVPResponses(templateId: string): Promise<unknown[] | null> {\r\n        try {\r\n            const cached = await this.kv.get(`${CACHE_KEYS.RSVP}${templateId}`, 'json');\r\n            return cached as unknown[] | null;\r\n        } catch {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Cache RSVP responses\r\n     */\r\n    async setRSVPResponses(templateId: string, responses: unknown[]): Promise<void> {\r\n        try {\r\n            await this.kv.put(\r\n                `${CACHE_KEYS.RSVP}${templateId}`,\r\n                JSON.stringify(responses),\r\n                { expirationTtl: CACHE_TTL.RSVP }\r\n            );\r\n        } catch (err) {\r\n            console.error('Failed to cache RSVP responses:', err);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Invalidate RSVP cache\r\n     */\r\n    async invalidateRSVP(templateId: string): Promise<void> {\r\n        try {\r\n            await this.kv.delete(`${CACHE_KEYS.RSVP}${templateId}`);\r\n        } catch (err) {\r\n            console.error('Failed to invalidate RSVP cache:', err);\r\n        }\r\n    }\r\n\r\n    // ============================================\r\n    // CACHE STATS & MONITORING\r\n    // ============================================\r\n\r\n    /**\r\n     * Track cache hit/miss (fire and forget)\r\n     */\r\n    async trackCacheHit(hit: boolean): Promise<void> {\r\n        const key = hit ? `${CACHE_KEYS.STATS}hits` : `${CACHE_KEYS.STATS}misses`;\r\n        try {\r\n            const current = await this.kv.get(key) || '0';\r\n            await this.kv.put(key, String(parseInt(current) + 1), {\r\n                expirationTtl: 86400, // Reset daily\r\n            });\r\n        } catch {\r\n            // Ignore errors in stats tracking - don't block response\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get cache hit rate\r\n     */\r\n    async getCacheHitRate(): Promise<{ hits: number; misses: number; rate: number }> {\r\n        try {\r\n            const hits = parseInt(await this.kv.get(`${CACHE_KEYS.STATS}hits`) || '0');\r\n            const misses = parseInt(await this.kv.get(`${CACHE_KEYS.STATS}misses`) || '0');\r\n            const total = hits + misses;\r\n            const rate = total > 0 ? (hits / total) * 100 : 0;\r\n\r\n            return { hits, misses, rate: Math.round(rate) };\r\n        } catch {\r\n            return { hits: 0, misses: 0, rate: 0 };\r\n        }\r\n    }\r\n\r\n    // ============================================\r\n    // UTILITY METHODS\r\n    // ============================================\r\n\r\n    /**\r\n     * Clear all caches (for development/debugging)\r\n     * WARNING: DISABLED IN PRODUCTION - This can consume hundreds of delete operations!\r\n     * Use individual invalidate methods instead.\r\n     */\r\n    async clearAll(): Promise<{ skipped: boolean; reason?: string }> {\r\n        // SAFETY: Disable mass delete to stay within free tier limits\r\n        console.warn('clearAll() is disabled to prevent exceeding KV delete limits');\r\n        return { skipped: true, reason: 'Mass delete disabled for free tier optimization' };\r\n    }\r\n\r\n    /**\r\n     * Get cache stats\r\n     */\r\n    async getStats(): Promise<{ keys: number; prefixes: Record<string, number>; hitRate: number }> {\r\n        try {\r\n            const list = await this.kv.list();\r\n            const prefixes: Record<string, number> = {};\r\n\r\n            list.keys.forEach((key) => {\r\n                const prefix = key.name.split(':')[0] + ':';\r\n                prefixes[prefix] = (prefixes[prefix] || 0) + 1;\r\n            });\r\n\r\n            const { rate } = await this.getCacheHitRate();\r\n\r\n            return {\r\n                keys: list.keys.length,\r\n                prefixes,\r\n                hitRate: rate,\r\n            };\r\n        } catch {\r\n            return { keys: 0, prefixes: {}, hitRate: 0 };\r\n        }\r\n    }\r\n}\r\n", "/**\r\n * Templates API Routes\r\n * Full CRUD operations for templates\r\n * OPTIMIZED FOR 10,000 USERS/MONTH - FREE TIER\r\n */\r\n\r\nimport { Hono } from 'hono';\r\nimport type { Env } from '../types';\r\nimport { DatabaseService } from '../services/database';\r\nimport { CacheService } from '../services/cache';\r\n\r\nexport const templatesRouter = new Hono<{ Bindings: Env }>();\r\n\r\n// ============================================\r\n// PUBLIC VIEW ENDPOINT (HIGHLY CACHED - FOR GUESTS)\r\n// 48-hour cache for maximum performance\r\n// ============================================\r\n\r\n// GET /api/templates/public/:id - Get public invitation view\r\ntemplatesRouter.get('/public/:id', async (c) => {\r\n    const id = c.req.param('id');\r\n    const cache = new CacheService(c.env.KV);\r\n\r\n    // Check public view cache first (48 hour TTL)\r\n    const cached = await cache.getPublicView(id);\r\n    if (cached) {\r\n        // Track cache hit (non-blocking)\r\n        c.executionCtx.waitUntil(cache.trackCacheHit(true));\r\n\r\n        // Return with aggressive cache headers\r\n        return c.json(cached, 200, {\r\n            'Cache-Control': 'public, max-age=7200, stale-while-revalidate=86400',\r\n            'CDN-Cache-Control': 'max-age=86400',\r\n            'X-Cache-Status': 'HIT',\r\n        });\r\n    }\r\n\r\n    // Track cache miss (non-blocking)\r\n    c.executionCtx.waitUntil(cache.trackCacheHit(false));\r\n\r\n    const db = new DatabaseService(c.env.DB);\r\n    const template = await db.getTemplate(id);\r\n\r\n    if (!template) {\r\n        return c.json({ error: 'Invitation not found' }, 404);\r\n    }\r\n\r\n    if (template.status !== 'published') {\r\n        return c.json({ error: 'Invitation not published' }, 404);\r\n    }\r\n\r\n    // Cache for future requests (non-blocking)\r\n    c.executionCtx.waitUntil(cache.setPublicView(id, template));\r\n\r\n    return c.json(template, 200, {\r\n        'Cache-Control': 'public, max-age=7200, stale-while-revalidate=86400',\r\n        'CDN-Cache-Control': 'max-age=86400',\r\n        'X-Cache-Status': 'MISS',\r\n    });\r\n});\r\n\r\n// ============================================\r\n// TEMPLATES LIST (ADMIN)\r\n// ============================================\r\n\r\n// GET /api/templates - List all templates\r\ntemplatesRouter.get('/', async (c) => {\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    // Try cache first\r\n    const cached = await cache.getTemplatesList();\r\n    if (cached) {\r\n        return c.json(cached, 200, {\r\n            'Cache-Control': 'private, max-age=60',\r\n            'X-Cache-Status': 'HIT',\r\n        });\r\n    }\r\n\r\n    // Fetch from database\r\n    const templates = await db.getTemplates();\r\n\r\n    // Cache the result\r\n    await cache.setTemplatesList(templates);\r\n\r\n    return c.json(templates, 200, {\r\n        'Cache-Control': 'private, max-age=60',\r\n        'X-Cache-Status': 'MISS',\r\n    });\r\n});\r\n\r\n// ============================================\r\n// SINGLE TEMPLATE (WITH SWR)\r\n// ============================================\r\n\r\n// GET /api/templates/:id - Get single template with full data\r\ntemplatesRouter.get('/:id', async (c) => {\r\n    const id = c.req.param('id');\r\n    const freshParam = c.req.query('fresh');\r\n    const skipCache = freshParam === 'true';\r\n\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    // If fresh=true is passed, skip cache entirely (used by editor after save)\r\n    if (!skipCache) {\r\n        // Try cache with stale-while-revalidate\r\n        const { value: cached, isStale, needsRevalidation } = await cache.getTemplate(id);\r\n\r\n        if (cached) {\r\n            // If stale but usable, revalidate in background (non-blocking)\r\n            if (needsRevalidation) {\r\n                console.log(`[TEMPLATES] Serving stale, revalidating ${id}...`);\r\n                c.executionCtx.waitUntil(revalidateInBackground(id, db, cache));\r\n            }\r\n\r\n            return c.json(cached, 200, {\r\n                'Cache-Control': 'private, max-age=60',\r\n                'X-Cache-Status': isStale ? 'STALE' : 'HIT',\r\n            });\r\n        }\r\n    } else {\r\n        console.log(`[TEMPLATES] Cache bypass requested for ${id}`);\r\n    }\r\n\r\n    console.log(`[TEMPLATES API] Fetching template ${id} from DB`);\r\n    // Fetch from database\r\n    const template = await db.getTemplate(id);\r\n\r\n    if (!template) {\r\n        return c.json({ error: 'Template not found' }, 404);\r\n    }\r\n\r\n    // Cache the result\r\n    await cache.setTemplate(id, template);\r\n\r\n    return c.json(template, 200, {\r\n        'Cache-Control': 'private, max-age=60',\r\n        'X-Cache-Status': 'MISS',\r\n    });\r\n});\r\n\r\n/**\r\n * Background revalidation (non-blocking)\r\n * Updates cache while user already received stale data\r\n */\r\nasync function revalidateInBackground(\r\n    id: string,\r\n    db: DatabaseService,\r\n    cache: CacheService\r\n): Promise<void> {\r\n    try {\r\n        const template = await db.getTemplate(id);\r\n        if (template) {\r\n            await cache.setTemplate(id, template);\r\n            console.log(`[REVALIDATE] Template ${id} refreshed in background`);\r\n        }\r\n    } catch (err) {\r\n        console.error(`[REVALIDATE] Failed for ${id}:`, err);\r\n    }\r\n}\r\n\r\n// ============================================\r\n// CREATE TEMPLATE\r\n// ============================================\r\n\r\n// POST /api/templates - Create new template\r\ntemplatesRouter.post('/', async (c) => {\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    const body = await c.req.json();\r\n\r\n    if (!body.name) {\r\n        return c.json({ error: 'Template name is required' }, 400);\r\n    }\r\n\r\n    const template = await db.createTemplate(body);\r\n\r\n    // Invalidate templates list only on CREATE (when list actually changes)\r\n    // This is the only place we need to invalidate the list\r\n    await cache.invalidateTemplatesList();\r\n\r\n    return c.json(template, 201);\r\n});\r\n\r\n// ============================================\r\n// UPDATE TEMPLATE\r\n// ============================================\r\n\r\n// PUT /api/templates/:id - Update template\r\ntemplatesRouter.put('/:id', async (c) => {\r\n    const id = c.req.param('id');\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    const body = await c.req.json();\r\n\r\n    await db.updateTemplate(id, body);\r\n\r\n    // Invalidate template cache only (1 delete instead of 3)\r\n    // Public view has 48h TTL and will refresh when user publishes\r\n    await cache.invalidateTemplate(id);\r\n\r\n    // Only invalidate public view if explicitly publishing\r\n    if (body.status === 'published') {\r\n        await cache.invalidatePublicView(id);\r\n    }\r\n\r\n    return c.json({ success: true });\r\n});\r\n\r\n\r\n// ============================================\r\n// DELETE TEMPLATE\r\n// ============================================\r\n\r\n// DELETE /api/templates/:id - Delete template\r\ntemplatesRouter.delete('/:id', async (c) => {\r\n    const id = c.req.param('id');\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    await db.deleteTemplate(id);\r\n\r\n    // Invalidate caches - DELETE truly changes the list, so invalidate it\r\n    await cache.invalidateTemplate(id);\r\n    await cache.invalidatePublicView(id);\r\n    await cache.invalidateTemplatesList(); // Only on DELETE, list actually changes\r\n\r\n    return c.json({ success: true });\r\n});\r\n", "/**\r\n * Sections API Routes\r\n * CRUD operations for template sections\r\n */\r\n\r\nimport { Hono } from 'hono';\r\nimport type { Env } from '../types';\r\nimport { DatabaseService } from '../services/database';\r\nimport { CacheService } from '../services/cache';\r\n\r\nexport const sectionsRouter = new Hono<{ Bindings: Env }>();\r\n\r\n// PUT /api/sections/:templateId/:type - Update or create section\r\nsectionsRouter.put('/:templateId/:type', async (c) => {\r\n    const templateId = c.req.param('templateId');\r\n    const sectionType = c.req.param('type');\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    const body = await c.req.json();\r\n\r\n    // DEBUG: Log incoming update request\r\n    console.log(`[SECTIONS API] PUT ${templateId}/${sectionType}`, JSON.stringify(body));\r\n\r\n    const sectionId = await db.upsertSection(templateId, sectionType, body);\r\n\r\n    // DEBUG: Log successful update\r\n    console.log(`[SECTIONS API] Updated section ${sectionId} successfully`);\r\n\r\n    // Invalidate template cache\r\n    await cache.invalidateTemplate(templateId);\r\n\r\n    return c.json({ success: true, sectionId });\r\n});\r\n\r\n// DELETE /api/sections/:templateId/:type - Delete section\r\nsectionsRouter.delete('/:templateId/:type', async (c) => {\r\n    const templateId = c.req.param('templateId');\r\n    const sectionType = c.req.param('type');\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    await db.deleteSection(templateId, sectionType);\r\n\r\n    // Invalidate template cache\r\n    await cache.invalidateTemplate(templateId);\r\n\r\n    return c.json({ success: true });\r\n});\r\n", "/**\r\n * Upload API Routes\r\n * R2 file upload, image proxy, and cleanup\r\n * OPTIMIZED FOR 10,000 USERS/MONTH - FREE TIER\r\n */\r\n\r\nimport { Hono } from 'hono';\r\nimport type { Env } from '../types';\r\n\r\nexport const uploadRouter = new Hono<{ Bindings: Env }>();\r\n\r\n// Allowed MIME types\r\nconst ALLOWED_TYPES = [\r\n    'image/jpeg',\r\n    'image/jpg',\r\n    'image/png',\r\n    'image/webp',\r\n    'image/gif',\r\n    'video/mp4',\r\n    'video/webm',\r\n    'video/ogg',\r\n];\r\n\r\n// Max file size (50MB)\r\nconst MAX_FILE_SIZE = 50 * 1024 * 1024;\r\n\r\n// R2 Public URL\r\nconst getR2PublicUrl = (env: Env) => env.R2_PUBLIC_URL || 'https://pub-1e0a9ae6152440268987d00a564a8da5.r2.dev';\r\n\r\n// API Base URL for proxy\r\nconst getApiBaseUrl = () => 'https://tamuu-api.shafania57.workers.dev';\r\n\r\n/**\r\n * Extract R2 key from various URL formats\r\n */\r\nfunction extractR2Key(url: string): string | null {\r\n    if (!url) return null;\r\n\r\n    try {\r\n        const parsedUrl = new URL(url);\r\n\r\n        // Handle proxy URL format\r\n        if (url.includes('/api/upload/proxy')) {\r\n            const originalUrl = parsedUrl.searchParams.get('url');\r\n            if (originalUrl) {\r\n                return extractR2Key(originalUrl);\r\n            }\r\n        }\r\n\r\n        // Handle direct R2 URL\r\n        if (parsedUrl.hostname.includes('r2.dev') ||\r\n            parsedUrl.hostname.includes('r2.cloudflarestorage.com')) {\r\n            return decodeURIComponent(parsedUrl.pathname.slice(1));\r\n        }\r\n    } catch {\r\n        return null;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n// ============================================\r\n// POST /api/upload - Upload file to R2\r\n// ============================================\r\nuploadRouter.post('/', async (c) => {\r\n    try {\r\n        const contentType = c.req.header('Content-Type') || '';\r\n\r\n        // Handle multipart form data\r\n        if (contentType.includes('multipart/form-data')) {\r\n            const formData = await c.req.formData();\r\n            const file = formData.get('file') as File | null;\r\n\r\n            if (!file) {\r\n                return c.json({ error: 'No file uploaded' }, 400);\r\n            }\r\n\r\n            if (!ALLOWED_TYPES.includes(file.type)) {\r\n                return c.json({ error: 'File type not allowed' }, 400);\r\n            }\r\n\r\n            if (file.size > MAX_FILE_SIZE) {\r\n                return c.json({ error: 'File too large' }, 400);\r\n            }\r\n\r\n            // Generate unique filename\r\n            const timestamp = Date.now();\r\n            const randomString = Math.random().toString(36).substring(7);\r\n            const extension = file.name.split('.').pop() || 'jpg';\r\n            const filename = `${timestamp}-${randomString}.${extension}`;\r\n\r\n            // Create path with date structure\r\n            const date = new Date();\r\n            const year = date.getFullYear();\r\n            const month = String(date.getMonth() + 1).padStart(2, '0');\r\n            const key = `photos/${year}/${month}/${filename}`;\r\n\r\n            // Upload to R2 with optimized metadata\r\n            const arrayBuffer = await file.arrayBuffer();\r\n            await c.env.R2.put(key, arrayBuffer, {\r\n                httpMetadata: {\r\n                    contentType: file.type,\r\n                    cacheControl: 'public, max-age=31536000, immutable',\r\n                },\r\n                customMetadata: {\r\n                    originalName: file.name,\r\n                    uploadedAt: new Date().toISOString(),\r\n                    size: String(file.size),\r\n                },\r\n            });\r\n\r\n            // Return optimized proxy URL instead of direct R2\r\n            const directUrl = `${getR2PublicUrl(c.env)}/${key}`;\r\n            const proxyUrl = `${getApiBaseUrl()}/api/upload/proxy?url=${encodeURIComponent(directUrl)}`;\r\n\r\n            return c.json({\r\n                success: true,\r\n                url: proxyUrl,      // Optimized proxy URL (cached)\r\n                directUrl,          // Direct R2 URL (for backup)\r\n                key,\r\n                filename,\r\n                size: file.size,\r\n                type: file.type,\r\n            });\r\n        }\r\n\r\n        return c.json({ error: 'Invalid content type' }, 400);\r\n    } catch (error) {\r\n        console.error('Upload error:', error);\r\n        return c.json({\r\n            error: 'Upload failed',\r\n            details: error instanceof Error ? error.message : 'Unknown error',\r\n        }, 500);\r\n    }\r\n});\r\n\r\n// ============================================\r\n// GET /api/upload/r2/* - Direct R2 file serving\r\n// Serves files directly from R2 bucket without external URL access\r\n// This bypasses SSL certificate issues with R2 public bucket\r\n// ============================================\r\nuploadRouter.get('/r2/*', async (c) => {\r\n    // Extract key from the URL path after /r2/\r\n    const fullPath = c.req.path;\r\n    const r2Prefix = '/api/upload/r2/';\r\n    const key = fullPath.startsWith(r2Prefix)\r\n        ? fullPath.slice(r2Prefix.length)\r\n        : c.req.param('*');\r\n\r\n    console.log('[R2 Direct] Requested key:', key, 'Full path:', fullPath);\r\n\r\n    if (!key) {\r\n        return c.json({ error: 'Missing file key', path: fullPath }, 400);\r\n    }\r\n\r\n    try {\r\n        const object = await c.env.R2.get(key);\r\n\r\n        if (!object) {\r\n            return c.json({ error: 'File not found', key }, 404);\r\n        }\r\n\r\n        const headers = new Headers();\r\n        headers.set('Content-Type', object.httpMetadata?.contentType || 'application/octet-stream');\r\n        headers.set('Cache-Control', 'public, max-age=31536000, immutable');\r\n        headers.set('CDN-Cache-Control', 'max-age=31536000');\r\n        headers.set('Access-Control-Allow-Origin', '*');\r\n        headers.set('ETag', `\"${object.etag}\"`);\r\n        headers.set('Content-Length', String(object.size));\r\n        headers.set('X-Cache-Status', 'DIRECT-R2');\r\n\r\n        return new Response(object.body, { headers });\r\n    } catch (error) {\r\n        console.error('[R2 Direct] Error:', error);\r\n        return c.json({\r\n            error: 'Failed to fetch file from R2',\r\n            details: error instanceof Error ? error.message : String(error),\r\n        }, 500);\r\n    }\r\n});\r\n\r\n// ============================================\r\n// GET /api/upload/proxy - Proxy image from R2\r\n// OPTIMIZED: Direct R2 bucket access (faster than HTTP fetch)\r\n// ============================================\r\nuploadRouter.get('/proxy', async (c) => {\r\n    const imageUrl = c.req.query('url');\r\n\r\n    if (!imageUrl) {\r\n        return c.json({ error: 'Missing url parameter' }, 400);\r\n    }\r\n\r\n    try {\r\n        const parsedUrl = new URL(imageUrl);\r\n\r\n        // Only allow R2 domains\r\n        const allowedDomains = [\r\n            'pub-1e0a9ae6152440268987d00a564a8da5.r2.dev',\r\n            'r2.cloudflarestorage.com',\r\n        ];\r\n\r\n        const isAllowed = allowedDomains.some(\r\n            (domain) => parsedUrl.hostname === domain || parsedUrl.hostname.endsWith('.' + domain)\r\n        );\r\n\r\n        if (!isAllowed) {\r\n            return c.json({ error: 'Domain not allowed' }, 403);\r\n        }\r\n\r\n        // Extract key from R2 URL for direct bucket access\r\n        const key = decodeURIComponent(parsedUrl.pathname.slice(1));\r\n        console.log(`[PROXY] Attempting to fetch key: ${key}`);\r\n\r\n        // Try to get from R2 bucket directly (FASTER than HTTP fetch)\r\n        let object = null;\r\n        try {\r\n            object = await c.env.R2.get(key);\r\n        } catch (r2Error) {\r\n            console.log(`[PROXY] Direct R2 access failed, falling back to HTTP: ${r2Error}`);\r\n        }\r\n\r\n        if (object) {\r\n            const headers = new Headers();\r\n            headers.set('Content-Type', object.httpMetadata?.contentType || 'image/jpeg');\r\n            headers.set('Cache-Control', 'public, max-age=31536000, immutable');\r\n            headers.set('CDN-Cache-Control', 'max-age=31536000');\r\n            headers.set('Vary', 'Accept-Encoding');\r\n            headers.set('Access-Control-Allow-Origin', '*');\r\n            headers.set('X-Cache-Status', 'HIT-R2');\r\n\r\n            // ETag for conditional requests (browser can skip download if unchanged)\r\n            headers.set('ETag', `\"${object.etag}\"`);\r\n\r\n            // Content-Length for better loading indicators\r\n            headers.set('Content-Length', String(object.size));\r\n\r\n            return new Response(object.body, { headers });\r\n        }\r\n\r\n        // Fallback: Fetch via HTTP if direct R2 access fails\r\n        console.log(`[PROXY] Fallback to HTTP fetch for: ${imageUrl}`);\r\n        const response = await fetch(imageUrl, {\r\n            headers: {\r\n                'User-Agent': 'Tamuu-Proxy/1.0',\r\n            },\r\n        });\r\n\r\n        if (!response.ok) {\r\n            console.error(`[PROXY] HTTP fetch failed: ${response.status} ${response.statusText}`);\r\n            return c.json({ error: `Failed to fetch image: ${response.status}` }, 500);\r\n        }\r\n\r\n        const fetchedContentType = response.headers.get('content-type') || 'image/jpeg';\r\n        const body = await response.arrayBuffer();\r\n\r\n        return new Response(body, {\r\n            headers: {\r\n                'Content-Type': fetchedContentType,\r\n                'Cache-Control': 'public, max-age=31536000, immutable',\r\n                'CDN-Cache-Control': 'max-age=31536000',\r\n                'Vary': 'Accept-Encoding',\r\n                'Access-Control-Allow-Origin': '*',\r\n                'X-Cache-Status': 'HIT-FETCH',\r\n            },\r\n        });\r\n    } catch (error) {\r\n        console.error('[PROXY] Error:', error);\r\n        return c.json({\r\n            error: 'Proxy failed',\r\n            details: error instanceof Error ? error.message : String(error)\r\n        }, 500);\r\n    }\r\n});\r\n\r\n// ============================================\r\n// GET /api/upload/info/* - Get image metadata\r\n// ============================================\r\nuploadRouter.get('/info/*', async (c) => {\r\n    const key = c.req.param('*');\r\n\r\n    if (!key) {\r\n        return c.json({ error: 'Missing key' }, 400);\r\n    }\r\n\r\n    try {\r\n        const object = await c.env.R2.head(key);\r\n\r\n        if (!object) {\r\n            return c.json({ error: 'Image not found' }, 404);\r\n        }\r\n\r\n        return c.json({\r\n            key,\r\n            size: object.size,\r\n            contentType: object.httpMetadata?.contentType,\r\n            uploaded: object.uploaded,\r\n            etag: object.etag,\r\n            customMetadata: object.customMetadata,\r\n        });\r\n    } catch (error) {\r\n        console.error('Info error:', error);\r\n        return c.json({ error: 'Failed to get info' }, 500);\r\n    }\r\n});\r\n\r\n// ============================================\r\n// DELETE /api/upload/* - Delete file from R2\r\n// Used for cleanup when elements are deleted\r\n// ============================================\r\nuploadRouter.delete('/*', async (c) => {\r\n    const key = c.req.param('*');\r\n\r\n    if (!key) {\r\n        return c.json({ error: 'Missing key' }, 400);\r\n    }\r\n\r\n    try {\r\n        // Check if file exists\r\n        const exists = await c.env.R2.head(key);\r\n        if (!exists) {\r\n            // File doesn't exist, but that's okay for cleanup\r\n            return c.json({\r\n                success: true,\r\n                deleted: key,\r\n                message: 'File not found (already deleted)',\r\n            });\r\n        }\r\n\r\n        // Delete from R2\r\n        await c.env.R2.delete(key);\r\n        console.log(`\uD83D\uDDD1\uFE0F Deleted from R2: ${key}`);\r\n\r\n        return c.json({\r\n            success: true,\r\n            deleted: key,\r\n            message: 'File deleted successfully',\r\n        });\r\n    } catch (error) {\r\n        console.error('Delete error:', error);\r\n        return c.json({ error: 'Delete failed' }, 500);\r\n    }\r\n});\r\n\r\n// Export helper for use in elements.ts\r\nexport { extractR2Key };\r\n", "/**\r\n * Elements API Routes\r\n * CRUD operations for template elements\r\n * OPTIMIZED: Auto-cleanup R2 images on delete\r\n */\r\n\r\nimport { Hono } from 'hono';\r\nimport type { Env } from '../types';\r\nimport { DatabaseService } from '../services/database';\r\nimport { CacheService } from '../services/cache';\r\nimport { extractR2Key } from './upload';\r\n\r\nexport const elementsRouter = new Hono<{ Bindings: Env }>();\r\n\r\n// POST /api/elements/:templateId/:sectionType - Create element\r\nelementsRouter.post('/:templateId/:sectionType', async (c) => {\r\n    const templateId = c.req.param('templateId');\r\n    const sectionType = c.req.param('sectionType');\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    const body = await c.req.json();\r\n\r\n    // First ensure section exists\r\n    let sectionId = await db.getSectionId(templateId, sectionType);\r\n    if (!sectionId) {\r\n        sectionId = await db.upsertSection(templateId, sectionType, {});\r\n    }\r\n\r\n    const element = await db.createElement(sectionId, body);\r\n\r\n    // Invalidate template cache\r\n    await cache.invalidateTemplate(templateId);\r\n\r\n    return c.json(element, 201);\r\n});\r\n\r\n// PUT /api/elements/:id - Update element\r\nelementsRouter.put('/:id', async (c) => {\r\n    const id = c.req.param('id');\r\n    const db = new DatabaseService(c.env.DB);\r\n    const cache = new CacheService(c.env.KV);\r\n\r\n    const body = await c.req.json();\r\n    console.log(`[ELEMENTS ROUTE] Updating element ${id}`);\r\n\r\n    const { _templateId, ...updates } = body;\r\n    const templateId = _templateId;\r\n\r\n    // If image is being changed, cleanup old image from R2\r\n    if (updates.imageUrl !== undefined) {\r\n        const oldElement = await db.getElement(id);\r\n        if (oldElement?.imageUrl && oldElement.imageUrl !== updates.imageUrl) {\r\n            const oldKey = extractR2Key(oldElement.imageUrl);\r\n            if (oldKey) {\r\n                try {\r\n                    await c.env.R2.delete(oldKey);\r\n                    console.log(`\uD83D\uDDD1\uFE0F Cleaned up old image: ${oldKey}`);\r\n                } catch (err) {\r\n                    console.error(`Failed to cleanup old image: ${oldKey}`, err);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    await db.updateElement(id, updates);\r\n\r\n    // Invalidate template cache if templateId provided\r\n    if (templateId) {\r\n        await cache.invalidateTemplate(templateId);\r\n    }\r\n\r\n    return c.json({ success: true });\r\n});\r\n\r\n// DELETE /api/elements/:id - Delete element with R2 cleanup\r\nelementsRouter.delete('/:id', async (c) => {\r\n    const id = c.req.param('id');\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    const templateId = c.req.query('templateId');\r\n\r\n    // Get element data first (to cleanup image if exists)\r\n    const element = await db.getElement(id);\r\n\r\n    // Delete from database\r\n    await db.deleteElement(id);\r\n\r\n    // Cleanup image from R2 if exists\r\n    if (element?.imageUrl) {\r\n        const key = extractR2Key(element.imageUrl);\r\n        if (key) {\r\n            try {\r\n                await c.env.R2.delete(key);\r\n                console.log(`\uD83D\uDDD1\uFE0F Deleted image from R2: ${key}`);\r\n            } catch (err) {\r\n                console.error(`Failed to delete R2 image: ${key}`, err);\r\n                // Don't fail the request if R2 delete fails\r\n            }\r\n        }\r\n    }\r\n\r\n    // Invalidate template cache if templateId provided\r\n    if (templateId) {\r\n        await cache.invalidateTemplate(templateId);\r\n    }\r\n\r\n    return c.json({ success: true });\r\n});\r\n", "/**\r\n * RSVP API Routes\r\n * Submit and retrieve RSVP responses\r\n */\r\n\r\nimport { Hono } from 'hono';\r\nimport type { Env } from '../types';\r\nimport { DatabaseService } from '../services/database';\r\nimport { CacheService } from '../services/cache';\r\n\r\nexport const rsvpRouter = new Hono<{ Bindings: Env }>();\r\n\r\n// POST /api/rsvp/:templateId - Submit RSVP\r\nrsvpRouter.post('/:templateId', async (c) => {\r\n    const templateId = c.req.param('templateId');\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    const body = await c.req.json();\r\n\r\n    if (!body.name) {\r\n        return c.json({ error: 'Name is required' }, 400);\r\n    }\r\n\r\n    const response = await db.submitRSVP(templateId, body);\r\n\r\n    // Invalidate RSVP cache\r\n    await cache.invalidateRSVP(templateId);\r\n\r\n    return c.json(response, 201);\r\n});\r\n\r\n// GET /api/rsvp/:templateId - Get RSVP responses\r\nrsvpRouter.get('/:templateId', async (c) => {\r\n    const templateId = c.req.param('templateId');\r\n    const cache = new CacheService(c.env.KV);\r\n    const db = new DatabaseService(c.env.DB);\r\n\r\n    // Try cache first\r\n    const cached = await cache.getRSVPResponses(templateId);\r\n    if (cached) {\r\n        return c.json(cached);\r\n    }\r\n\r\n    // Fetch from database\r\n    const responses = await db.getRSVPResponses(templateId);\r\n\r\n    // Cache the result\r\n    await cache.setRSVPResponses(templateId, responses);\r\n\r\n    return c.json(responses);\r\n});\r\n", "// src/utils/cookie.ts\nimport { decodeURIComponent_, tryDecode } from \"./url.js\";\nvar algorithm = { name: \"HMAC\", hash: \"SHA-256\" };\nvar getCryptoKey = async (secret) => {\n  const secretBuf = typeof secret === \"string\" ? new TextEncoder().encode(secret) : secret;\n  return await crypto.subtle.importKey(\"raw\", secretBuf, algorithm, false, [\"sign\", \"verify\"]);\n};\nvar makeSignature = async (value, secret) => {\n  const key = await getCryptoKey(secret);\n  const signature = await crypto.subtle.sign(algorithm.name, key, new TextEncoder().encode(value));\n  return btoa(String.fromCharCode(...new Uint8Array(signature)));\n};\nvar verifySignature = async (base64Signature, value, secret) => {\n  try {\n    const signatureBinStr = atob(base64Signature);\n    const signature = new Uint8Array(signatureBinStr.length);\n    for (let i = 0, len = signatureBinStr.length; i < len; i++) {\n      signature[i] = signatureBinStr.charCodeAt(i);\n    }\n    return await crypto.subtle.verify(algorithm, secret, signature, new TextEncoder().encode(value));\n  } catch {\n    return false;\n  }\n};\nvar validCookieNameRegEx = /^[\\w!#$%&'*.^`|~+-]+$/;\nvar validCookieValueRegEx = /^[ !#-:<-[\\]-~]*$/;\nvar parse = (cookie, name) => {\n  if (name && cookie.indexOf(name) === -1) {\n    return {};\n  }\n  const pairs = cookie.trim().split(\";\");\n  const parsedCookie = {};\n  for (let pairStr of pairs) {\n    pairStr = pairStr.trim();\n    const valueStartPos = pairStr.indexOf(\"=\");\n    if (valueStartPos === -1) {\n      continue;\n    }\n    const cookieName = pairStr.substring(0, valueStartPos).trim();\n    if (name && name !== cookieName || !validCookieNameRegEx.test(cookieName)) {\n      continue;\n    }\n    let cookieValue = pairStr.substring(valueStartPos + 1).trim();\n    if (cookieValue.startsWith('\"') && cookieValue.endsWith('\"')) {\n      cookieValue = cookieValue.slice(1, -1);\n    }\n    if (validCookieValueRegEx.test(cookieValue)) {\n      parsedCookie[cookieName] = cookieValue.indexOf(\"%\") !== -1 ? tryDecode(cookieValue, decodeURIComponent_) : cookieValue;\n      if (name) {\n        break;\n      }\n    }\n  }\n  return parsedCookie;\n};\nvar parseSigned = async (cookie, secret, name) => {\n  const parsedCookie = {};\n  const secretKey = await getCryptoKey(secret);\n  for (const [key, value] of Object.entries(parse(cookie, name))) {\n    const signatureStartPos = value.lastIndexOf(\".\");\n    if (signatureStartPos < 1) {\n      continue;\n    }\n    const signedValue = value.substring(0, signatureStartPos);\n    const signature = value.substring(signatureStartPos + 1);\n    if (signature.length !== 44 || !signature.endsWith(\"=\")) {\n      continue;\n    }\n    const isVerified = await verifySignature(signature, signedValue, secretKey);\n    parsedCookie[key] = isVerified ? signedValue : false;\n  }\n  return parsedCookie;\n};\nvar _serialize = (name, value, opt = {}) => {\n  let cookie = `${name}=${value}`;\n  if (name.startsWith(\"__Secure-\") && !opt.secure) {\n    throw new Error(\"__Secure- Cookie must have Secure attributes\");\n  }\n  if (name.startsWith(\"__Host-\")) {\n    if (!opt.secure) {\n      throw new Error(\"__Host- Cookie must have Secure attributes\");\n    }\n    if (opt.path !== \"/\") {\n      throw new Error('__Host- Cookie must have Path attributes with \"/\"');\n    }\n    if (opt.domain) {\n      throw new Error(\"__Host- Cookie must not have Domain attributes\");\n    }\n  }\n  if (opt && typeof opt.maxAge === \"number\" && opt.maxAge >= 0) {\n    if (opt.maxAge > 3456e4) {\n      throw new Error(\n        \"Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.\"\n      );\n    }\n    cookie += `; Max-Age=${opt.maxAge | 0}`;\n  }\n  if (opt.domain && opt.prefix !== \"host\") {\n    cookie += `; Domain=${opt.domain}`;\n  }\n  if (opt.path) {\n    cookie += `; Path=${opt.path}`;\n  }\n  if (opt.expires) {\n    if (opt.expires.getTime() - Date.now() > 3456e7) {\n      throw new Error(\n        \"Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.\"\n      );\n    }\n    cookie += `; Expires=${opt.expires.toUTCString()}`;\n  }\n  if (opt.httpOnly) {\n    cookie += \"; HttpOnly\";\n  }\n  if (opt.secure) {\n    cookie += \"; Secure\";\n  }\n  if (opt.sameSite) {\n    cookie += `; SameSite=${opt.sameSite.charAt(0).toUpperCase() + opt.sameSite.slice(1)}`;\n  }\n  if (opt.priority) {\n    cookie += `; Priority=${opt.priority.charAt(0).toUpperCase() + opt.priority.slice(1)}`;\n  }\n  if (opt.partitioned) {\n    if (!opt.secure) {\n      throw new Error(\"Partitioned Cookie must have Secure attributes\");\n    }\n    cookie += \"; Partitioned\";\n  }\n  return cookie;\n};\nvar serialize = (name, value, opt) => {\n  value = encodeURIComponent(value);\n  return _serialize(name, value, opt);\n};\nvar serializeSigned = async (name, value, secret, opt = {}) => {\n  const signature = await makeSignature(value, secret);\n  value = `${value}.${signature}`;\n  value = encodeURIComponent(value);\n  return _serialize(name, value, opt);\n};\nexport {\n  parse,\n  parseSigned,\n  serialize,\n  serializeSigned\n};\n", "// src/helper/cookie/index.ts\nimport { parse, parseSigned, serialize, serializeSigned } from \"../../utils/cookie.js\";\nvar getCookie = (c, key, prefix) => {\n  const cookie = c.req.raw.headers.get(\"Cookie\");\n  if (typeof key === \"string\") {\n    if (!cookie) {\n      return void 0;\n    }\n    let finalKey = key;\n    if (prefix === \"secure\") {\n      finalKey = \"__Secure-\" + key;\n    } else if (prefix === \"host\") {\n      finalKey = \"__Host-\" + key;\n    }\n    const obj2 = parse(cookie, finalKey);\n    return obj2[finalKey];\n  }\n  if (!cookie) {\n    return {};\n  }\n  const obj = parse(cookie);\n  return obj;\n};\nvar getSignedCookie = async (c, secret, key, prefix) => {\n  const cookie = c.req.raw.headers.get(\"Cookie\");\n  if (typeof key === \"string\") {\n    if (!cookie) {\n      return void 0;\n    }\n    let finalKey = key;\n    if (prefix === \"secure\") {\n      finalKey = \"__Secure-\" + key;\n    } else if (prefix === \"host\") {\n      finalKey = \"__Host-\" + key;\n    }\n    const obj2 = await parseSigned(cookie, secret, finalKey);\n    return obj2[finalKey];\n  }\n  if (!cookie) {\n    return {};\n  }\n  const obj = await parseSigned(cookie, secret);\n  return obj;\n};\nvar generateCookie = (name, value, opt) => {\n  let cookie;\n  if (opt?.prefix === \"secure\") {\n    cookie = serialize(\"__Secure-\" + name, value, { path: \"/\", ...opt, secure: true });\n  } else if (opt?.prefix === \"host\") {\n    cookie = serialize(\"__Host-\" + name, value, {\n      ...opt,\n      path: \"/\",\n      secure: true,\n      domain: void 0\n    });\n  } else {\n    cookie = serialize(name, value, { path: \"/\", ...opt });\n  }\n  return cookie;\n};\nvar setCookie = (c, name, value, opt) => {\n  const cookie = generateCookie(name, value, opt);\n  c.header(\"Set-Cookie\", cookie, { append: true });\n};\nvar generateSignedCookie = async (name, value, secret, opt) => {\n  let cookie;\n  if (opt?.prefix === \"secure\") {\n    cookie = await serializeSigned(\"__Secure-\" + name, value, secret, {\n      path: \"/\",\n      ...opt,\n      secure: true\n    });\n  } else if (opt?.prefix === \"host\") {\n    cookie = await serializeSigned(\"__Host-\" + name, value, secret, {\n      ...opt,\n      path: \"/\",\n      secure: true,\n      domain: void 0\n    });\n  } else {\n    cookie = await serializeSigned(name, value, secret, { path: \"/\", ...opt });\n  }\n  return cookie;\n};\nvar setSignedCookie = async (c, name, value, secret, opt) => {\n  const cookie = await generateSignedCookie(name, value, secret, opt);\n  c.header(\"set-cookie\", cookie, { append: true });\n};\nvar deleteCookie = (c, name, opt) => {\n  const deletedCookie = getCookie(c, name, opt?.prefix);\n  setCookie(c, name, \"\", { ...opt, maxAge: 0 });\n  return deletedCookie;\n};\nexport {\n  deleteCookie,\n  generateCookie,\n  generateSignedCookie,\n  getCookie,\n  getSignedCookie,\n  setCookie,\n  setSignedCookie\n};\n", "/**\r\n * Authentication API Routes\r\n * Register, Login, Password Reset, Email Verification\r\n * Enterprise-grade JWT-based auth for Cloudflare Workers\r\n */\r\n\r\nimport { Hono } from 'hono';\r\nimport { setCookie, getCookie, deleteCookie } from 'hono/cookie';\r\nimport type { Env, DBUser, UserResponse, AuthTokenPayload } from '../types';\r\n\r\nexport const authRouter = new Hono<{ Bindings: Env }>();\r\n\r\n// ============================================\r\n// CONSTANTS\r\n// ============================================\r\nconst JWT_SECRET = 'tamuu-jwt-secret-2024'; // In production, use env variable\r\nconst JWT_EXPIRY_DAYS = 7;\r\nconst SALT_ROUNDS = 10;\r\n\r\n// ============================================\r\n// HELPERS\r\n// ============================================\r\n\r\n// Simple UUID generator\r\nfunction generateUUID(): string {\r\n    const hex = (n: number) => Math.floor(Math.random() * 16).toString(16);\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\r\n        const r = Math.floor(Math.random() * 16);\r\n        const v = c === 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n}\r\n\r\n// Simple password hashing (using Web Crypto API)\r\nasync function hashPassword(password: string): Promise<string> {\r\n    const encoder = new TextEncoder();\r\n    const data = encoder.encode(password + JWT_SECRET);\r\n    const hash = await crypto.subtle.digest('SHA-256', data);\r\n    return Array.from(new Uint8Array(hash))\r\n        .map(b => b.toString(16).padStart(2, '0'))\r\n        .join('');\r\n}\r\n\r\nasync function verifyPassword(password: string, hash: string): Promise<boolean> {\r\n    const computed = await hashPassword(password);\r\n    return computed === hash;\r\n}\r\n\r\n// JWT helpers using Web Crypto\r\nasync function createJWT(payload: Omit<AuthTokenPayload, 'exp'>): Promise<string> {\r\n    const header = { alg: 'HS256', typ: 'JWT' };\r\n    const exp = Math.floor(Date.now() / 1000) + (JWT_EXPIRY_DAYS * 24 * 60 * 60);\r\n    const fullPayload = { ...payload, exp };\r\n\r\n    const base64Header = btoa(JSON.stringify(header));\r\n    const base64Payload = btoa(JSON.stringify(fullPayload));\r\n\r\n    const encoder = new TextEncoder();\r\n    const key = await crypto.subtle.importKey(\r\n        'raw',\r\n        encoder.encode(JWT_SECRET),\r\n        { name: 'HMAC', hash: 'SHA-256' },\r\n        false,\r\n        ['sign']\r\n    );\r\n\r\n    const signature = await crypto.subtle.sign(\r\n        'HMAC',\r\n        key,\r\n        encoder.encode(`${base64Header}.${base64Payload}`)\r\n    );\r\n\r\n    const base64Signature = btoa(String.fromCharCode(...new Uint8Array(signature)));\r\n\r\n    return `${base64Header}.${base64Payload}.${base64Signature}`;\r\n}\r\n\r\nasync function verifyJWT(token: string): Promise<AuthTokenPayload | null> {\r\n    try {\r\n        const [header, payload, signature] = token.split('.');\r\n        if (!header || !payload || !signature) return null;\r\n\r\n        // Verify signature\r\n        const encoder = new TextEncoder();\r\n        const key = await crypto.subtle.importKey(\r\n            'raw',\r\n            encoder.encode(JWT_SECRET),\r\n            { name: 'HMAC', hash: 'SHA-256' },\r\n            false,\r\n            ['verify']\r\n        );\r\n\r\n        const signatureData = Uint8Array.from(atob(signature), c => c.charCodeAt(0));\r\n        const isValid = await crypto.subtle.verify(\r\n            'HMAC',\r\n            key,\r\n            signatureData,\r\n            encoder.encode(`${header}.${payload}`)\r\n        );\r\n\r\n        if (!isValid) return null;\r\n\r\n        const decoded = JSON.parse(atob(payload)) as AuthTokenPayload;\r\n\r\n        // Check expiry\r\n        if (decoded.exp && decoded.exp < Math.floor(Date.now() / 1000)) {\r\n            return null;\r\n        }\r\n\r\n        return decoded;\r\n    } catch {\r\n        return null;\r\n    }\r\n}\r\n\r\n// Map DB user to API response\r\nfunction mapUserToResponse(user: DBUser): UserResponse {\r\n    return {\r\n        id: user.id,\r\n        email: user.email,\r\n        name: user.name,\r\n        phone: user.phone,\r\n        avatarUrl: user.avatar_url,\r\n        plan: user.plan,\r\n        planExpiresAt: user.plan_expires_at,\r\n        isVerified: user.is_verified === 1,\r\n        createdAt: user.created_at,\r\n        updatedAt: user.updated_at,\r\n    };\r\n}\r\n\r\n// ============================================\r\n// ROUTES\r\n// ============================================\r\n\r\n// POST /api/auth/register - Create new account\r\nauthRouter.post('/register', async (c) => {\r\n    const body = await c.req.json();\r\n    const { email, password, name, phone } = body;\r\n\r\n    // Validate required fields\r\n    if (!email || !password) {\r\n        return c.json({ error: 'Email and password are required' }, 400);\r\n    }\r\n\r\n    // Validate email format\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(email)) {\r\n        return c.json({ error: 'Invalid email format' }, 400);\r\n    }\r\n\r\n    // Validate password length\r\n    if (password.length < 8) {\r\n        return c.json({ error: 'Password must be at least 8 characters' }, 400);\r\n    }\r\n\r\n    // Check if email already exists\r\n    const existing = await c.env.DB\r\n        .prepare('SELECT id FROM users WHERE email = ?')\r\n        .bind(email.toLowerCase())\r\n        .first();\r\n\r\n    if (existing) {\r\n        return c.json({ error: 'Email already registered' }, 409);\r\n    }\r\n\r\n    // Create user\r\n    const id = generateUUID();\r\n    const passwordHash = await hashPassword(password);\r\n    const verificationToken = generateUUID();\r\n    const now = new Date().toISOString();\r\n\r\n    await c.env.DB\r\n        .prepare(`\r\n            INSERT INTO users (id, email, password_hash, name, phone, verification_token, created_at, updated_at)\r\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?)\r\n        `)\r\n        .bind(id, email.toLowerCase(), passwordHash, name || null, phone || null, verificationToken, now, now)\r\n        .run();\r\n\r\n    // Get created user\r\n    const user = await c.env.DB\r\n        .prepare('SELECT * FROM users WHERE id = ?')\r\n        .bind(id)\r\n        .first<DBUser>();\r\n\r\n    if (!user) {\r\n        return c.json({ error: 'Failed to create user' }, 500);\r\n    }\r\n\r\n    // Create JWT token\r\n    const token = await createJWT({ userId: user.id, email: user.email });\r\n\r\n    // Set cookie\r\n    setCookie(c, 'auth_token', token, {\r\n        httpOnly: true,\r\n        secure: true,\r\n        sameSite: 'Lax',\r\n        maxAge: JWT_EXPIRY_DAYS * 24 * 60 * 60,\r\n        path: '/',\r\n    });\r\n\r\n    return c.json({\r\n        user: mapUserToResponse(user),\r\n        token,\r\n        message: 'Registration successful. Please verify your email.',\r\n    }, 201);\r\n});\r\n\r\n// POST /api/auth/login - Login with email/password\r\nauthRouter.post('/login', async (c) => {\r\n    const body = await c.req.json();\r\n    const { email, password } = body;\r\n\r\n    if (!email || !password) {\r\n        return c.json({ error: 'Email and password are required' }, 400);\r\n    }\r\n\r\n    // Find user\r\n    const user = await c.env.DB\r\n        .prepare('SELECT * FROM users WHERE email = ?')\r\n        .bind(email.toLowerCase())\r\n        .first<DBUser>();\r\n\r\n    if (!user) {\r\n        return c.json({ error: 'Invalid email or password' }, 401);\r\n    }\r\n\r\n    // Verify password\r\n    const isValid = await verifyPassword(password, user.password_hash);\r\n    if (!isValid) {\r\n        return c.json({ error: 'Invalid email or password' }, 401);\r\n    }\r\n\r\n    // Create JWT token\r\n    const token = await createJWT({ userId: user.id, email: user.email });\r\n\r\n    // Set cookie\r\n    setCookie(c, 'auth_token', token, {\r\n        httpOnly: true,\r\n        secure: true,\r\n        sameSite: 'Lax',\r\n        maxAge: JWT_EXPIRY_DAYS * 24 * 60 * 60,\r\n        path: '/',\r\n    });\r\n\r\n    return c.json({\r\n        user: mapUserToResponse(user),\r\n        token,\r\n    });\r\n});\r\n\r\n// POST /api/auth/logout - Clear auth cookie\r\nauthRouter.post('/logout', async (c) => {\r\n    deleteCookie(c, 'auth_token', { path: '/' });\r\n    return c.json({ success: true });\r\n});\r\n\r\n// GET /api/auth/me - Get current user from token\r\nauthRouter.get('/me', async (c) => {\r\n    // Try cookie first, then Authorization header\r\n    let token = getCookie(c, 'auth_token');\r\n\r\n    if (!token) {\r\n        const authHeader = c.req.header('Authorization');\r\n        if (authHeader?.startsWith('Bearer ')) {\r\n            token = authHeader.slice(7);\r\n        }\r\n    }\r\n\r\n    if (!token) {\r\n        return c.json({ error: 'Not authenticated' }, 401);\r\n    }\r\n\r\n    const payload = await verifyJWT(token);\r\n    if (!payload) {\r\n        deleteCookie(c, 'auth_token', { path: '/' });\r\n        return c.json({ error: 'Invalid or expired token' }, 401);\r\n    }\r\n\r\n    const user = await c.env.DB\r\n        .prepare('SELECT * FROM users WHERE id = ?')\r\n        .bind(payload.userId)\r\n        .first<DBUser>();\r\n\r\n    if (!user) {\r\n        return c.json({ error: 'User not found' }, 404);\r\n    }\r\n\r\n    return c.json({ user: mapUserToResponse(user) });\r\n});\r\n\r\n// PUT /api/auth/profile - Update user profile\r\nauthRouter.put('/profile', async (c) => {\r\n    let token = getCookie(c, 'auth_token');\r\n\r\n    if (!token) {\r\n        const authHeader = c.req.header('Authorization');\r\n        if (authHeader?.startsWith('Bearer ')) {\r\n            token = authHeader.slice(7);\r\n        }\r\n    }\r\n\r\n    if (!token) {\r\n        return c.json({ error: 'Not authenticated' }, 401);\r\n    }\r\n\r\n    const payload = await verifyJWT(token);\r\n    if (!payload) {\r\n        return c.json({ error: 'Invalid or expired token' }, 401);\r\n    }\r\n\r\n    const body = await c.req.json();\r\n    const { name, phone, avatarUrl } = body;\r\n\r\n    const now = new Date().toISOString();\r\n    await c.env.DB\r\n        .prepare(`\r\n            UPDATE users \r\n            SET name = COALESCE(?, name), \r\n                phone = COALESCE(?, phone), \r\n                avatar_url = COALESCE(?, avatar_url),\r\n                updated_at = ?\r\n            WHERE id = ?\r\n        `)\r\n        .bind(name, phone, avatarUrl, now, payload.userId)\r\n        .run();\r\n\r\n    const user = await c.env.DB\r\n        .prepare('SELECT * FROM users WHERE id = ?')\r\n        .bind(payload.userId)\r\n        .first<DBUser>();\r\n\r\n    if (!user) {\r\n        return c.json({ error: 'User not found' }, 404);\r\n    }\r\n\r\n    return c.json({ user: mapUserToResponse(user) });\r\n});\r\n\r\n// POST /api/auth/forgot-password - Request password reset\r\nauthRouter.post('/forgot-password', async (c) => {\r\n    const body = await c.req.json();\r\n    const { email } = body;\r\n\r\n    if (!email) {\r\n        return c.json({ error: 'Email is required' }, 400);\r\n    }\r\n\r\n    const user = await c.env.DB\r\n        .prepare('SELECT * FROM users WHERE email = ?')\r\n        .bind(email.toLowerCase())\r\n        .first<DBUser>();\r\n\r\n    if (!user) {\r\n        // Don't reveal if email exists\r\n        return c.json({ message: 'If email exists, reset link will be sent' });\r\n    }\r\n\r\n    const resetToken = generateUUID();\r\n    const resetExpires = new Date(Date.now() + 60 * 60 * 1000).toISOString(); // 1 hour\r\n\r\n    await c.env.DB\r\n        .prepare(`\r\n            UPDATE users SET reset_token = ?, reset_token_expires = ? WHERE id = ?\r\n        `)\r\n        .bind(resetToken, resetExpires, user.id)\r\n        .run();\r\n\r\n    // TODO: Send email with reset link\r\n    console.log(`[AUTH] Password reset token for ${email}: ${resetToken}`);\r\n\r\n    return c.json({ message: 'If email exists, reset link will be sent' });\r\n});\r\n\r\n// POST /api/auth/reset-password - Reset password with token\r\nauthRouter.post('/reset-password', async (c) => {\r\n    const body = await c.req.json();\r\n    const { token, newPassword } = body;\r\n\r\n    if (!token || !newPassword) {\r\n        return c.json({ error: 'Token and new password are required' }, 400);\r\n    }\r\n\r\n    if (newPassword.length < 8) {\r\n        return c.json({ error: 'Password must be at least 8 characters' }, 400);\r\n    }\r\n\r\n    const user = await c.env.DB\r\n        .prepare('SELECT * FROM users WHERE reset_token = ?')\r\n        .bind(token)\r\n        .first<DBUser>();\r\n\r\n    if (!user) {\r\n        return c.json({ error: 'Invalid or expired reset token' }, 400);\r\n    }\r\n\r\n    // Check if token expired\r\n    if (user.reset_token_expires && new Date(user.reset_token_expires) < new Date()) {\r\n        return c.json({ error: 'Reset token has expired' }, 400);\r\n    }\r\n\r\n    const passwordHash = await hashPassword(newPassword);\r\n    const now = new Date().toISOString();\r\n\r\n    await c.env.DB\r\n        .prepare(`\r\n            UPDATE users \r\n            SET password_hash = ?, reset_token = NULL, reset_token_expires = NULL, updated_at = ?\r\n            WHERE id = ?\r\n        `)\r\n        .bind(passwordHash, now, user.id)\r\n        .run();\r\n\r\n    return c.json({ message: 'Password reset successful' });\r\n});\r\n\r\n// GET /api/auth/verify/:token - Verify email\r\nauthRouter.get('/verify/:token', async (c) => {\r\n    const token = c.req.param('token');\r\n\r\n    const user = await c.env.DB\r\n        .prepare('SELECT * FROM users WHERE verification_token = ?')\r\n        .bind(token)\r\n        .first<DBUser>();\r\n\r\n    if (!user) {\r\n        return c.json({ error: 'Invalid verification token' }, 400);\r\n    }\r\n\r\n    const now = new Date().toISOString();\r\n    await c.env.DB\r\n        .prepare(`\r\n            UPDATE users \r\n            SET is_verified = 1, verification_token = NULL, updated_at = ?\r\n            WHERE id = ?\r\n        `)\r\n        .bind(now, user.id)\r\n        .run();\r\n\r\n    return c.json({ message: 'Email verified successfully' });\r\n});\r\n", "/**\r\n * Batch Update API Route\r\n * Enterprise-grade batch update endpoint for Tamuu\r\n * \r\n * OPTIMIZATION: Single endpoint to update multiple sections and elements\r\n * - Reduces N API calls to 1\r\n * - Single KV cache invalidation\r\n * - D1 batch execution for atomicity\r\n * \r\n * @author CTO Engineering Team\r\n * @version 1.0.0\r\n */\r\n\r\nimport { Hono } from 'hono';\r\nimport type { Env, SectionDesign, TemplateElement } from '../types';\r\nimport { DatabaseService } from '../services/database';\r\nimport { CacheService } from '../services/cache';\r\n\r\nexport const batchRouter = new Hono<{ Bindings: Env }>();\r\n\r\n// ============================================\r\n// TYPE DEFINITIONS\r\n// ============================================\r\n\r\ninterface BatchSectionUpdate {\r\n    sectionType: string;\r\n    updates: Partial<SectionDesign>;\r\n}\r\n\r\ninterface BatchElementUpdate {\r\n    elementId: string;\r\n    updates: Partial<TemplateElement>;\r\n}\r\n\r\ninterface BatchUpdateRequest {\r\n    templateId: string;\r\n    sections?: BatchSectionUpdate[];\r\n    elements?: BatchElementUpdate[];\r\n}\r\n\r\ninterface BatchUpdateResponse {\r\n    success: boolean;\r\n    updated: {\r\n        sections: number;\r\n        elements: number;\r\n        total: number;\r\n    };\r\n    errors: string[];\r\n    duration: number;\r\n}\r\n\r\n// ============================================\r\n// VALIDATION CONSTANTS (Enterprise limits)\r\n// ============================================\r\n\r\nconst MAX_SECTIONS_PER_BATCH = 50;\r\nconst MAX_ELEMENTS_PER_BATCH = 500;\r\n\r\n// ============================================\r\n// BATCH UPDATE ENDPOINT\r\n// ============================================\r\n\r\n/**\r\n * POST /api/batch-update\r\n * \r\n * Batch update multiple sections and elements in a single request\r\n * with single cache invalidation at the end.\r\n */\r\nbatchRouter.post('/', async (c) => {\r\n    const startTime = Date.now();\r\n    const errors: string[] = [];\r\n    let sectionsUpdated = 0;\r\n    let elementsUpdated = 0;\r\n\r\n    try {\r\n        // 1. Parse and validate request body\r\n        const body = await c.req.json<BatchUpdateRequest>();\r\n\r\n        // 2. Validate required fields\r\n        if (!body.templateId) {\r\n            return c.json<BatchUpdateResponse>({\r\n                success: false,\r\n                updated: { sections: 0, elements: 0, total: 0 },\r\n                errors: ['templateId is required'],\r\n                duration: Date.now() - startTime\r\n            }, 400);\r\n        }\r\n\r\n        const sections = body.sections || [];\r\n        const elements = body.elements || [];\r\n\r\n        // 3. Validate batch size limits (prevent abuse)\r\n        if (sections.length > MAX_SECTIONS_PER_BATCH) {\r\n            return c.json<BatchUpdateResponse>({\r\n                success: false,\r\n                updated: { sections: 0, elements: 0, total: 0 },\r\n                errors: [`Maximum ${MAX_SECTIONS_PER_BATCH} sections per batch allowed`],\r\n                duration: Date.now() - startTime\r\n            }, 400);\r\n        }\r\n\r\n        if (elements.length > MAX_ELEMENTS_PER_BATCH) {\r\n            return c.json<BatchUpdateResponse>({\r\n                success: false,\r\n                updated: { sections: 0, elements: 0, total: 0 },\r\n                errors: [`Maximum ${MAX_ELEMENTS_PER_BATCH} elements per batch allowed`],\r\n                duration: Date.now() - startTime\r\n            }, 400);\r\n        }\r\n\r\n        // 4. Check if there's anything to update\r\n        if (sections.length === 0 && elements.length === 0) {\r\n            return c.json<BatchUpdateResponse>({\r\n                success: true,\r\n                updated: { sections: 0, elements: 0, total: 0 },\r\n                errors: [],\r\n                duration: Date.now() - startTime\r\n            }, 200);\r\n        }\r\n\r\n        // 5. Initialize services\r\n        const db = new DatabaseService(c.env.DB);\r\n        const cache = new CacheService(c.env.KV);\r\n\r\n        // 6. Verify template exists\r\n        const templateExists = await db.getTemplate(body.templateId);\r\n        if (!templateExists) {\r\n            return c.json<BatchUpdateResponse>({\r\n                success: false,\r\n                updated: { sections: 0, elements: 0, total: 0 },\r\n                errors: ['Template not found'],\r\n                duration: Date.now() - startTime\r\n            }, 404);\r\n        }\r\n\r\n        // 7. Process section updates\r\n        for (const sectionUpdate of sections) {\r\n            try {\r\n                if (!sectionUpdate.sectionType) {\r\n                    errors.push(`Section update missing sectionType`);\r\n                    continue;\r\n                }\r\n\r\n                await db.upsertSection(\r\n                    body.templateId,\r\n                    sectionUpdate.sectionType,\r\n                    sectionUpdate.updates\r\n                );\r\n                sectionsUpdated++;\r\n            } catch (error) {\r\n                const msg = error instanceof Error ? error.message : String(error);\r\n                errors.push(`Section ${sectionUpdate.sectionType}: ${msg}`);\r\n                console.error(`[BATCH] Section update failed:`, error);\r\n            }\r\n        }\r\n\r\n        // 8. Process element updates\r\n        for (const elementUpdate of elements) {\r\n            try {\r\n                if (!elementUpdate.elementId) {\r\n                    errors.push(`Element update missing elementId`);\r\n                    continue;\r\n                }\r\n\r\n                // Skip temp IDs (they should be created first, not updated via batch)\r\n                if (elementUpdate.elementId.startsWith('el-') ||\r\n                    elementUpdate.elementId.startsWith('temp-')) {\r\n                    console.log(`[BATCH] Skipping temp element: ${elementUpdate.elementId}`);\r\n                    continue;\r\n                }\r\n\r\n                await db.updateElement(\r\n                    elementUpdate.elementId,\r\n                    elementUpdate.updates\r\n                );\r\n                elementsUpdated++;\r\n            } catch (error) {\r\n                const msg = error instanceof Error ? error.message : String(error);\r\n                errors.push(`Element ${elementUpdate.elementId}: ${msg}`);\r\n                console.error(`[BATCH] Element update failed:`, error);\r\n            }\r\n        }\r\n\r\n        // 9. SINGLE CACHE INVALIDATION - This is the key optimization!\r\n        // Only invalidate once after all updates are complete\r\n        if (sectionsUpdated > 0 || elementsUpdated > 0) {\r\n            await cache.invalidateTemplate(body.templateId);\r\n            console.log(`[BATCH] Cache invalidated for template ${body.templateId}`);\r\n        }\r\n\r\n        // 10. Return response\r\n        const totalUpdated = sectionsUpdated + elementsUpdated;\r\n        const duration = Date.now() - startTime;\r\n\r\n        console.log(`[BATCH] Completed: ${totalUpdated} updates in ${duration}ms (${errors.length} errors)`);\r\n\r\n        return c.json<BatchUpdateResponse>({\r\n            success: errors.length === 0,\r\n            updated: {\r\n                sections: sectionsUpdated,\r\n                elements: elementsUpdated,\r\n                total: totalUpdated\r\n            },\r\n            errors,\r\n            duration\r\n        }, errors.length === 0 ? 200 : 207); // 207 = Multi-Status (partial success)\r\n\r\n    } catch (error) {\r\n        console.error('[BATCH] Unexpected error:', error);\r\n        return c.json<BatchUpdateResponse>({\r\n            success: false,\r\n            updated: {\r\n                sections: sectionsUpdated,\r\n                elements: elementsUpdated,\r\n                total: sectionsUpdated + elementsUpdated\r\n            },\r\n            errors: [error instanceof Error ? error.message : 'Unknown error'],\r\n            duration: Date.now() - startTime\r\n        }, 500);\r\n    }\r\n});\r\n", "/**\r\n * Tamuu API - Cloudflare Workers Entry Point\r\n * Enterprise-grade API for digital invitation platform\r\n * OPTIMIZED FOR 10,000 USERS/MONTH - FREE TIER\r\n */\r\n\r\nimport { Hono } from 'hono';\r\nimport { cors } from 'hono/cors';\r\nimport { logger } from 'hono/logger';\r\nimport { prettyJSON } from 'hono/pretty-json';\r\nimport type { Env } from './types';\r\n\r\n// Import routes\r\nimport { templatesRouter } from './routes/templates';\r\nimport { sectionsRouter } from './routes/sections';\r\nimport { elementsRouter } from './routes/elements';\r\nimport { rsvpRouter } from './routes/rsvp';\r\nimport { uploadRouter } from './routes/upload';\r\nimport { authRouter } from './routes/auth';\r\nimport { batchRouter } from './routes/batch';\r\n\r\n\r\n// Create Hono app with environment type\r\nconst app = new Hono<{ Bindings: Env }>();\r\n\r\n// ============================================\r\n// MIDDLEWARE (OPTIMIZED)\r\n// ============================================\r\n\r\n// Note: Cloudflare Workers automatically handles gzip compression at the edge\r\n// Don't use compress() middleware here as it causes double-compression issues\r\n\r\n\r\n// Request timing middleware\r\napp.use('*', async (c, next) => {\r\n    const start = Date.now();\r\n    await next();\r\n    const duration = Date.now() - start;\r\n    c.res.headers.set('X-Response-Time', `${duration}ms`);\r\n});\r\n\r\n// CORS configuration for frontend\r\napp.use('*', cors({\r\n    origin: (origin) => {\r\n        // Allow specific origins\r\n        const allowedOrigins = [\r\n            'https://tamuu.pages.dev',\r\n            'http://localhost:5173',\r\n            'http://localhost:4173',\r\n        ];\r\n\r\n        if (allowedOrigins.includes(origin)) {\r\n            return origin;\r\n        }\r\n\r\n        // Allow preview deployments (*.tamuu.pages.dev)\r\n        if (origin && origin.endsWith('.tamuu.pages.dev')) {\r\n            return origin;\r\n        }\r\n\r\n        return null;\r\n    },\r\n    allowMethods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS'],\r\n    allowHeaders: ['Content-Type', 'Authorization', 'X-Requested-With'],\r\n    exposeHeaders: ['Content-Length', 'X-Request-Id', 'X-Response-Time', 'X-Cache-Status'],\r\n    maxAge: 86400, // 24 hours\r\n    credentials: true,\r\n}));\r\n\r\n// Request logging (only errors in production for performance)\r\napp.use('*', logger());\r\n\r\n// Pretty JSON responses\r\napp.use('*', prettyJSON());\r\n\r\n// Default cache headers for API responses\r\napp.use('/api/*', async (c, next) => {\r\n    await next();\r\n\r\n    // Don't override existing cache headers\r\n    if (c.res.headers.has('Cache-Control')) return;\r\n\r\n    // No cache for mutations\r\n    if (['POST', 'PUT', 'DELETE', 'PATCH'].includes(c.req.method)) {\r\n        c.res.headers.set('Cache-Control', 'no-store');\r\n        return;\r\n    }\r\n\r\n    // Default short cache for GET requests\r\n    c.res.headers.set('Cache-Control', 'public, max-age=60, stale-while-revalidate=300');\r\n});\r\n\r\n// ============================================\r\n// HEALTH CHECK\r\n// ============================================\r\n\r\napp.get('/', (c) => {\r\n    return c.json({\r\n        status: 'ok',\r\n        message: 'Tamuu API is running',\r\n        version: '1.0.0',\r\n        timestamp: new Date().toISOString(),\r\n    });\r\n});\r\n\r\napp.get('/health', async (c) => {\r\n    try {\r\n        // Check D1 connection\r\n        const dbCheck = await c.env.DB.prepare('SELECT 1 as check').first();\r\n\r\n        // Check KV connection\r\n        await c.env.KV.put('health_check', 'ok', { expirationTtl: 60 });\r\n        const kvCheck = await c.env.KV.get('health_check');\r\n\r\n        return c.json({\r\n            status: 'healthy',\r\n            services: {\r\n                d1: dbCheck ? 'connected' : 'error',\r\n                kv: kvCheck === 'ok' ? 'connected' : 'error',\r\n                r2: 'available',\r\n            },\r\n            timestamp: new Date().toISOString(),\r\n        });\r\n    } catch (error) {\r\n        return c.json({\r\n            status: 'unhealthy',\r\n            error: error instanceof Error ? error.message : 'Unknown error',\r\n            timestamp: new Date().toISOString(),\r\n        }, 500);\r\n    }\r\n});\r\n\r\n// ============================================\r\n// DIAGNOSTIC ROUTES\r\n// ============================================\r\n\r\napp.get('/api/debug/columns', async (c) => {\r\n    try {\r\n        const result = await c.env.DB.prepare('PRAGMA table_info(template_sections)').all();\r\n        return c.json({\r\n            table: 'template_sections',\r\n            columns: result.results.map((r: any) => ({\r\n                name: r.name,\r\n                type: r.type,\r\n                dflt_value: r.dflt_value\r\n            }))\r\n        });\r\n    } catch (error) {\r\n        return c.json({ error: true, message: error instanceof Error ? error.message : String(error) }, 500);\r\n    }\r\n});\r\n\r\n// ============================================\r\n// API ROUTES\r\n// ============================================\r\n\r\n// Mount routers\r\napp.route('/api/templates', templatesRouter);\r\napp.route('/api/sections', sectionsRouter);\r\napp.route('/api/elements', elementsRouter);\r\napp.route('/api/rsvp', rsvpRouter);\r\napp.route('/api/upload', uploadRouter);\r\napp.route('/api/auth', authRouter);\r\napp.route('/api/batch-update', batchRouter);\r\n\r\n\r\n// ============================================\r\n// ERROR HANDLING\r\n// ============================================\r\n\r\napp.onError((err, c) => {\r\n    console.error('API Error:', err);\r\n\r\n    return c.json({\r\n        error: true,\r\n        message: err.message || 'Internal Server Error',\r\n        ...(c.env.ENVIRONMENT !== 'production' && { stack: err.stack }),\r\n    }, 500);\r\n});\r\n\r\napp.notFound((c) => {\r\n    return c.json({\r\n        error: true,\r\n        message: 'Not Found',\r\n        path: c.req.path,\r\n    }, 404);\r\n});\r\n\r\n// Export for Cloudflare Workers\r\nexport default app;\r\n"],
  "mappings": "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",
  "names": ["match", "raw", "app", "Node", "_Node", "Node", "Hono", "Hono", "Hono", "Hono", "Hono", "Hono", "Hono", "generateUUID", "Hono", "Hono"]
}
